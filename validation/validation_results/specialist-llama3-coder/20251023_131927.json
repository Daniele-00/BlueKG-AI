{
  "config": "specialist-llama3-coder",
  "approach": "specialist",
  "config_name": "llama3-coder",
  "timestamp": "20251023_131927",
  "examples_top_k": 2,
  "summary": {
    "total": 106,
    "success_attendibile": 81,
    "success_strict": 81,
    "success_similarity": 88,
    "success_jaccard": 81,
    "failures": 25,
    "accuracy": 76.41509433962264,
    "accuracy_strict": 76.41509433962264,
    "accuracy_similarity": 83.01886792452831,
    "accuracy_jaccard": 76.41509433962264,
    "min_query_similarity": 0.8,
    "min_jaccard": 0.8,
    "avg_time": 34.85896945753539,
    "avg_jaccard": 0.7798588900539447,
    "avg_query_similarity": 0.9075353409474304
  },
  "results": [
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-01-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato totale del cliente BARONE DI FERRANTE EZIO?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS fatturatoTotale",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoTotale",
      "time_total": 28.018542907200754,
      "time_generation": 23.420613549649715,
      "time_db": 0.46633890084922314,
      "time_synthesis": 2.1338729760609567,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-02-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il cliente con il maggior fatturato?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 34.958154059015214,
      "time_generation": 31.17062936583534,
      "time_db": 0.3743285071104765,
      "time_synthesis": 1.4051566710695624,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-03-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i 5 clienti che hanno fatturato di pi\u00f9 che si trovano a Perugia",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.provincia)) = 'perugia'\nMATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC\nLIMIT 5",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.localita)) = 'perugia' MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 5",
      "time_total": 24.320707409642637,
      "time_generation": 21.112530710641295,
      "time_db": 0.05120744416490197,
      "time_synthesis": 1.4747244892641902,
      "jaccard_index": 0.0,
      "query_similarity": 0.9762282091917591,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "cliente": "ITALICA RETAIL SRL",
          "fatturatoTotale": 428074.78000000014
        },
        {
          "cliente": "SUPERMERCATO PERUGIA SRL",
          "fatturatoTotale": 135061.40000000008
        },
        {
          "cliente": "UMBRIAFRIGO SRL",
          "fatturatoTotale": 1105408.41
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-04-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 5 prodotti pi\u00f9 popolari in termini di quantit\u00e0 venduta",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nRETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 5",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 5",
      "time_total": 28.785036806948483,
      "time_generation": 23.505408745259047,
      "time_db": 0.6843092278577387,
      "time_synthesis": 3.203353250864893,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-05-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 5 prodotti meno popolari in termini di quantit\u00e0 venduta",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nRETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale ASC\nLIMIT 5",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale ASC LIMIT 5",
      "time_total": 27.723522616084665,
      "time_generation": 23.499050982762128,
      "time_db": 0.47116650687530637,
      "time_synthesis": 2.4884700546972454,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-06-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Dimmi il fatturato di ogni ditta.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 34.45078865205869,
      "time_generation": 30.133563338778913,
      "time_db": 0.5884253149852157,
      "time_synthesis": 2.2184173041023314,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-07-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Il fatturato di ogni ditta, nel loro anno migliore",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale\nORDER BY d.dittaId, fatturatoAnnuale DESC\nWITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati\nRETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY d.dittaId, fatturatoAnnuale DESC WITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati RETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 40.28921770770103,
      "time_generation": 34.86534696025774,
      "time_db": 0.5215389584191144,
      "time_synthesis": 3.5587965422309935,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-08-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Il fatturato di ogni ditta, nel loro anno peggiore",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale\nORDER BY d.dittaId, fatturatoAnnuale DESC\nWITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati\nRETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoWorst, fatturatiOrdinati[0].fatturato AS fatturatoWorst",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY d.dittaId, fatturatoAnnuale ASC WITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati RETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 44.11314460169524,
      "time_generation": 32.71216289512813,
      "time_db": 0.6963806110434234,
      "time_synthesis": 9.38426426704973,
      "jaccard_index": 0.0,
      "query_similarity": 0.9780564263322884,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "ditta": "2",
          "annoTop": 2025,
          "fatturatoMassimo": 1365461.8499999994
        },
        {
          "ditta": "4",
          "annoTop": 2025,
          "fatturatoMassimo": 26752.0
        },
        {
          "ditta": "3",
          "annoTop": 2025,
          "fatturatoMassimo": 60777.76
        }
      ],
      "mismatch_extra": [
        {
          "ditta": "2",
          "annoWorst": 2023,
          "fatturatoWorst": 10866139.410000047
        },
        {
          "ditta": "1",
          "annoWorst": 2024,
          "fatturatoWorst": 1242423.36
        },
        {
          "ditta": "3",
          "annoWorst": 2024,
          "fatturatoWorst": 804346.0799999994
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-09-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la famiglia di prodotti pi\u00f9 acquistata?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) \nRETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale \nORDER BY quantitaTotale DESC \nLIMIT 1",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) RETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 1",
      "time_total": 28.078653459902853,
      "time_generation": 23.895340744871646,
      "time_db": 0.4414357063360512,
      "time_synthesis": 1.7528518438339233,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-10-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la famiglia di prodotti meno acquistata?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia)\nRETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale ASC\nLIMIT 1",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) RETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale ASC LIMIT 1",
      "time_total": 27.784804177004844,
      "time_generation": 23.80748659092933,
      "time_db": 0.5634995698928833,
      "time_synthesis": 1.96193553134799,
      "jaccard_index": 1.0,
      "query_similarity": 0.9982363315696648,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-11-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il prodotto pi\u00f9 venduto in generale (per valore)?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto\nORDER BY valoreVenduto DESC\nLIMIT 1",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto ORDER BY valoreVenduto DESC LIMIT 1",
      "time_total": 45.991392347961664,
      "time_generation": 40.452863316982985,
      "time_db": 0.40809048106893897,
      "time_synthesis": 1.8196379598230124,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-12-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il prodotto meno venduto in generale (per valore)?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto \nORDER BY valoreVenduto ASC LIMIT 1",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto ORDER BY valoreVenduto ASC LIMIT 1",
      "time_total": 31.073195178061724,
      "time_generation": 27.36135768610984,
      "time_db": 0.5516729541122913,
      "time_synthesis": 1.7514881249517202,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-13-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "A quanto ho acquistato il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) \nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' \nRETURN sum(dr.importo) AS costoTotaleAcquisto",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' RETURN sum(dr.importo) AS costoTotaleAcquisto",
      "time_total": 23.10381285380572,
      "time_generation": 19.25724176503718,
      "time_db": 0.19063242757692933,
      "time_synthesis": 2.0996801601722836,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-14-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "A quanto l'ho venduto il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN sum(dr.importo) AS totaleVenduto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS totaleVenduto",
      "time_total": 25.443862776272,
      "time_generation": 21.648020793218166,
      "time_db": 0.5630412548780441,
      "time_synthesis": 1.5318056335672736,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-15-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Situazione attuale della ditta '2'",
      "success": false,
      "error": "API error 500: {'detail': 'Errore durante l\\'elaborazione: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input \\'(\\': expected an identifier (line 5, column 10 (offset: 258))\\n\"    c",
      "generated_cypher": null,
      "expected_cypher": "MATCH (d:Ditta {dittaId: '2'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year IN [date().year, date().year - 1] RETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY anno DESC",
      "time_total": null,
      "time_generation": null,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": null,
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": 2
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-16-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali ditte vendono prodotti della famiglia 'CENTRALI FRIGO'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) \nWHERE toLower(trim(fam.nome)) = 'centrali frigo' \nRETURN DISTINCT d.dittaId AS ditta \nORDER BY ditta",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' RETURN DISTINCT d.dittaId AS ditta ORDER BY ditta",
      "time_total": 26.079256729222834,
      "time_generation": 21.95857389178127,
      "time_db": 0.481338017154485,
      "time_synthesis": 1.5813467768020928,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-17-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanti clienti unici ha la ditta '1'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)\nRETURN count(DISTINCT c) AS numeroClientiUnici",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente) RETURN count(DISTINCT c) AS numeroClientiUnici",
      "time_total": 13.802288027945906,
      "time_generation": 10.83821987407282,
      "time_db": 0.01308743515983224,
      "time_synthesis": 1.4378272229805589,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-18-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore ci ha inviato pi\u00f9 documenti?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nRETURN f.ragioneSociale AS fornitore, count(doc) AS numeroDocumenti\nORDER BY numeroDocumenti DESC\nLIMIT 1",
      "expected_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento) RETURN f.ragioneSociale AS fornitore, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC LIMIT 1",
      "time_total": 15.744767263997346,
      "time_generation": 11.84537017531693,
      "time_db": 0.05825073504820466,
      "time_synthesis": 1.849391889758408,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-19-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 clienti che non hanno mai acquistato il prodotto 'GAS FREON SOLSTICE N40 R448A'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' \nWITH a MATCH (c:Cliente) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) \nRETURN c.name AS cliente ORDER BY cliente LIMIT 5",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' WITH a MATCH (c:Cliente) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) RETURN c.name AS cliente ORDER BY cliente LIMIT 5",
      "time_total": 20.399417269043624,
      "time_generation": 15.578201628755778,
      "time_db": 0.313010364305228,
      "time_synthesis": 2.951489618048072,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-20-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la localit\u00e0 con il maggior numero di fornitori?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:SI_TROVA_A]->(l:Luogo)\nWHERE l.localita IS NOT NULL\nRETURN l.localita AS localita, count(DISTINCT f) AS numeroFornitori\nORDER BY numeroFornitori DESC\nLIMIT 1",
      "expected_cypher": "MATCH (f:Fornitore)-[:SI_TROVA_A]->(l:Luogo) WHERE l.localita IS NOT NULL RETURN l.localita AS localita, count(DISTINCT f) AS numeroFornitori ORDER BY numeroFornitori DESC LIMIT 1",
      "time_total": 23.655630683060735,
      "time_generation": 20.273573901038617,
      "time_db": 0.05431126803159714,
      "time_synthesis": 1.8927017450332642,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-21-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo medio per riga documento nelle fatture di vendita?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento {tipoOriginale: \"Fattura di vendita\"})-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN avg(dr.importo) AS importoMedioRiga",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN avg(dr.importo) AS importoMedioRiga",
      "time_total": 41.60224031191319,
      "time_generation": 37.855157117825,
      "time_db": 0.1477168332785368,
      "time_synthesis": 2.3953278572298586,
      "jaccard_index": 0.0,
      "query_similarity": 0.9035532994923858,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "importoMedioRiga": 795.876842594409
        }
      ],
      "mismatch_extra": [
        {
          "importoMedioRiga": null
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-22-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami 10 documenti di tipo 'FVC' emessi a Gennaio 2025 al cliente 'L'ABBONDANZA SRL'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.tipoOriginale = 'FVC' AND doc.dataEmissione >= datetime('2025-01-01') AND doc.dataEmissione <= datetime('2025-01-31')\nAND f.ragioneSociale = 'L\\'ABBONDANZA SRL'\nRETURN DISTINCT doc.documentoId AS documento, dr.importo AS costo\nORDER BY costo DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) WHERE toLower(trim(c.name)) = 'l\\'abbondanza srl' AND dt.codice = 'FVC' AND doc.dataEmissione.year = 2025 AND doc.dataEmissione.month = 1 RETURN doc.documentoId AS documento LIMIT 10",
      "time_total": 32.1153153819032,
      "time_generation": 24.661758656147867,
      "time_db": 0.20535188913345337,
      "time_synthesis": 5.890009584836662,
      "jaccard_index": 0.0,
      "query_similarity": 0.4466338259441708,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "documento": "2-202500001231"
        },
        {
          "documento": "2-202500001226"
        },
        {
          "documento": "2-202500000829"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-23-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il margine di profitto del prodotto 'GAS FREON SOLSTICE N40 R448A'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr1:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr1.tipoValore = 'Fatturato' AND dr1.importo > 0\nWITH a, sum(dr1.importo) AS fatturato\nMATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nWITH a, fatturato, sum(dr2.importo) AS costo\nRETURN a.descrizione AS prodotto, fatturato, costo, (fatturato - costo) AS margine",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr1:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr1.tipoValore = 'Fatturato' AND dr1.importo > 0 WITH a, sum(dr1.importo) AS fatturato MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) WITH a, fatturato, sum(dr2.importo) AS costo RETURN a.descrizione AS prodotto, fatturato, costo, (fatturato - costo) AS margine",
      "time_total": 52.821935242041945,
      "time_generation": 49.100460229907185,
      "time_db": 0.4158296650275588,
      "time_synthesis": 1.9018738782033324,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-24-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali fornitori ci forniscono prodotti venduti al cliente 'BARONE DI FERRANTE EZIO'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente {name: 'BARONE DI FERRANTE EZIO'})-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH collect(DISTINCT a) AS articoliVenduti\nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nWHERE a IN articoliVenduti\nRETURN DISTINCT gf.ragioneSociale AS fornitore ORDER BY fornitore",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' WITH collect(DISTINCT a) AS articoliVenduti MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) WHERE a IN articoliVenduti RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER BY fornitore",
      "time_total": 42.59491918515414,
      "time_generation": 36.83196374680847,
      "time_db": 0.2640850329771638,
      "time_synthesis": 4.304757550824434,
      "jaccard_index": 1.0,
      "query_similarity": 0.8995535714285714,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-25-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 prodotti che abbiamo venduto ma mai acquistato",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE NOT EXISTS {\n  MATCH (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)\n}\nRETURN DISTINCT a.descrizione AS prodotto\nORDER BY prodotto\nLIMIT 5",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE NOT EXISTS { MATCH (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) } RETURN DISTINCT a.descrizione AS prodotto ORDER BY prodotto LIMIT 5",
      "time_total": 35.82291205832735,
      "time_generation": 32.56845465209335,
      "time_db": 0.3848974956199527,
      "time_synthesis": 1.546669949311763,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-26-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 prodotti che abbiamo acquistato ma mai venduto",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) \nWHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: 'Fatturato'}) \nRETURN DISTINCT a.descrizione AS prodottoMaiVenduto ORDER BY prodottoMaiVenduto LIMIT 5",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)\nWHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: 'Fatturato'})\nRETURN DISTINCT a.descrizione AS prodottoMaiVenduto\nORDER BY prodottoMaiVenduto\nLIMIT 5",
      "time_total": 37.9280702280812,
      "time_generation": 33.674903699662536,
      "time_db": 0.23261338379234076,
      "time_synthesis": 2.609781791921705,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-27-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato della sottofamiglia 'COMPRESSORI SEMIERMETICI'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia) \nWHERE toLower(trim(sf.nome)) = 'compressori semiermetici' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN sum(dr.importo) AS fatturatoSottofamiglia",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia) WHERE toLower(trim(sf.nome)) = 'compressori semiermetici' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoSottofamiglia",
      "time_total": 29.478494063019753,
      "time_generation": 25.508941599167883,
      "time_db": 0.6415768493898213,
      "time_synthesis": 1.4199189012870193,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-28-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca le sottofamiglie della famiglia 'CENTRALI FRIGO'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Famiglia)<-[:INCLUSA_IN]-(sf:Sottofamiglia) WHERE toLower(trim(f.nome)) = 'centrali frigo' RETURN DISTINCT sf.nome AS sottofamiglia ORDER BY sottofamiglia",
      "expected_cypher": "MATCH (f:Famiglia)<-[:INCLUSA_IN]-(sf:Sottofamiglia) WHERE toLower(trim(f.nome)) = 'centrali frigo' RETURN DISTINCT sf.nome AS sottofamiglia ORDER BY sottofamiglia",
      "time_total": 17.099550526123494,
      "time_generation": 13.17683532088995,
      "time_db": 0.008982520084828138,
      "time_synthesis": 2.5102037372998893,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-29-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato del primo trimestre 2024?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nAND doc.dataEmissione.year = 2024 AND doc.dataEmissione.month >= 1 AND doc.dataEmissione.month <= 3\nRETURN sum(dr.importo) AS fatturatoTrimestre",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024 AND doc.dataEmissione.month >= 1 AND doc.dataEmissione.month <= 3 RETURN sum(dr.importo) AS fatturatoTrimestre",
      "time_total": 43.03913549380377,
      "time_generation": 39.84951525600627,
      "time_db": 0.13766694022342563,
      "time_synthesis": 1.5660908468998969,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-30-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato tra Gennaio 2024 e Marzo 2024?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione >= date('2024-01-01') AND doc.dataEmissione <= date('2024-03-31')\nRETURN sum(dr.importo) AS fatturatoPeriodo",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione >= date('2024-01-01') AND doc.dataEmissione <= date('2024-03-31') RETURN sum(dr.importo) AS fatturatoPeriodo",
      "time_total": 49.944307728204876,
      "time_generation": 46.587097868323326,
      "time_db": 0.035609638318419456,
      "time_synthesis": 1.5308293607085943,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-31-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i clienti con fatturato superiore a 50000 euro",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nWITH c, sum(dr.importo) AS fatturatoTotale \nWHERE fatturatoTotale > 50000 \nRETURN c.name AS cliente, fatturatoTotale \nORDER BY fatturatoTotale DESC",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS fatturatoTotale WHERE fatturatoTotale > 50000 RETURN c.name AS cliente, fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 34.057038153056055,
      "time_generation": 26.583695211913437,
      "time_db": 0.3902865662239492,
      "time_synthesis": 5.458256454672664,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-32-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 3 prodotti pi\u00f9 venduti al cliente 'BARONE DI FERRANTE EZIO'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente {name: 'BARONE DI FERRANTE EZIO'})-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN a.descrizione AS prodotto, sum(dr.importo) AS totaleVenduto\nORDER BY totaleVenduto DESC\nLIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS totaleVenduto ORDER BY totaleVenduto DESC LIMIT 3",
      "time_total": 28.909058345016092,
      "time_generation": 25.077005688101053,
      "time_db": 0.009033902082592249,
      "time_synthesis": 2.2353187571279705,
      "jaccard_index": 1.0,
      "query_similarity": 0.8616352201257862,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-33-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 3 prodotti meno venduti al cliente 'BARONE DI FERRANTE EZIO'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN a.descrizione AS prodotto, sum(dr.importo) AS totaleVenduto\nORDER BY totaleVenduto ASC\nLIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS totaleVenduto ORDER BY totaleVenduto ASC LIMIT 3",
      "time_total": 40.51807347498834,
      "time_generation": 36.813846494071186,
      "time_db": 0.4130878490395844,
      "time_synthesis": 1.7687406279146671,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-34-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanti fornitori appartengono a ciascun gruppo di fornitori?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore) \nRETURN gf.ragioneSociale AS gruppo, count(f) AS numeroFornitori \nORDER BY numeroFornitori DESC",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore) RETURN gf.ragioneSociale AS gruppo, count(f) AS numeroFornitori ORDER BY numeroFornitori DESC",
      "time_total": 23.26840696670115,
      "time_generation": 16.428166235797107,
      "time_db": 0.923239863011986,
      "time_synthesis": 4.765713578090072,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-35-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo minimo registrato in una singola riga di fattura di vendita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN min(dr.importo) AS importoMinimo",
      "expected_cypher": "MATCH (dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN min(dr.importo) AS importoMinimo",
      "time_total": 25.924150076694787,
      "time_generation": 22.746687171049416,
      "time_db": 0.09082776959985495,
      "time_synthesis": 1.2474241158924997,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-36-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo massimo registrato in una singola riga di fattura di vendita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN max(dr.importo) AS importoMassimo",
      "expected_cypher": "MATCH (dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN max(dr.importo) AS importoMassimo",
      "time_total": 27.87197017809376,
      "time_generation": 24.27051443280652,
      "time_db": 0.09723039763048291,
      "time_synthesis": 1.5701471837237477,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-37-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la quantit\u00e0 media di articoli per riga nei documenti di acquisto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nRETURN avg(dr.quantita) AS quantitaMediaAcquisto",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) RETURN avg(dr.quantita) AS quantitaMediaAcquisto",
      "time_total": 14.904029357247055,
      "time_generation": 11.349290663842112,
      "time_db": 0.10495015094056726,
      "time_synthesis": 2.000438803806901,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-38-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanti articoli unici sono presenti nel catalogo?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo) RETURN count(DISTINCT a) AS totaleArticoli",
      "expected_cypher": "MATCH (a:Articolo) RETURN count(DISTINCT a) AS totaleArticoli",
      "time_total": 13.996444073971361,
      "time_generation": 11.466314787976444,
      "time_db": 0.01013469835743308,
      "time_synthesis": 1.0802379846572876,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-39-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i clienti dell'azienda '1' situati nella provincia di 'PG'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.provincia)) = 'pg' RETURN c.name AS cliente ORDER BY cliente",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.provincia)) = 'pg' RETURN c.name AS cliente ORDER BY cliente",
      "time_total": 18.861011989880353,
      "time_generation": 13.197864272166044,
      "time_db": 0.25631522526964545,
      "time_synthesis": 3.977726744953543,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-40-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Calcola il fatturato totale per il secondo trimestre del 2024 (aprile, maggio, giugno).",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nAND doc.dataEmissione.year = 2024\nAND doc.dataEmissione.month IN [4, 5, 6]\nRETURN sum(dr.importo) AS fatturatoTrimestre",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024 AND doc.dataEmissione.month IN [4, 5, 6] RETURN sum(dr.importo) AS fatturatoTrimestre",
      "time_total": 39.5682595577091,
      "time_generation": 36.46376690408215,
      "time_db": 0.10897250799462199,
      "time_synthesis": 1.638943858910352,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-41-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Trova tutti gli articoli la cui descrizione inizia con 'TUBO'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (a:Articolo) \nWHERE toLower(trim(a.descrizione)) STARTS WITH 'tubo'\nRETURN a.descrizione AS articolo\nORDER BY articolo\nLIMIT 20",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) STARTS WITH 'tubo' RETURN a.descrizione AS articolo",
      "time_total": 20.686355827376246,
      "time_generation": 13.543090048711747,
      "time_db": 0.1314027481712401,
      "time_synthesis": 5.463965306058526,
      "jaccard_index": 0.03202846975088968,
      "query_similarity": 0.8860759493670886,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "articolo": "TUBO PVC"
        },
        {
          "articolo": "TUBO RAME RIC. D.10-12"
        },
        {
          "articolo": "TUBO RAME RIC. D.19-22"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-42-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i documenti di tipo 'FNA' ricevuti dal fornitore 'FORNITORE ESEMPIO SPA'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore {ragioneSociale: 'FORNITORE ESEMPIO SPA'})-[:HA_EMESSO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) WHERE dt.codice = 'FNA' RETURN doc.documentoId AS documento",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) WHERE toLower(trim(gf.ragioneSociale)) = 'fornitore esempio spa' AND dt.codice = 'FNA' RETURN doc.documentoId AS documento",
      "time_total": 21.49695457983762,
      "time_generation": 18.045054148882627,
      "time_db": 0.13722914410755038,
      "time_synthesis": 1.5381950470618904,
      "jaccard_index": 1.0,
      "query_similarity": 0.5470459518599562,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-43-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi sono i 3 clienti con il fatturato pi\u00f9 basso?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale ASC LIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale ASC LIMIT 3",
      "time_total": 40.165907382033765,
      "time_generation": 35.66183903394267,
      "time_db": 0.46018833713606,
      "time_synthesis": 2.767224613111466,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-44-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi sono i 3 clienti con il fatturato pi\u00f9 alto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC\nLIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 3",
      "time_total": 28.995991439092904,
      "time_generation": 22.476460248231888,
      "time_db": 0.3597732773050666,
      "time_synthesis": 2.8484980282373726,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-45-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 5 articoli con il costo totale di acquisto pi\u00f9 alto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH f, a, sum(dr.importo) AS costoTotale\nORDER BY costoTotale DESC\nLIMIT 5\nRETURN f.ragioneSociale AS fornitore, a.descrizione AS articolo, costoTotale AS costoTotaleAcquisto",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) RETURN a.descrizione AS articolo, sum(dr.importo) AS costoTotale ORDER BY costoTotale DESC LIMIT 5",
      "time_total": 65.07108570588753,
      "time_generation": 28.27246682997793,
      "time_db": 28.408035737928003,
      "time_synthesis": 6.10800263332203,
      "jaccard_index": 0.0,
      "query_similarity": 0.3742690058479532,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "articolo": "GAS FREON SOLSTICE N40 R448A",
          "costoTotale": 578501.2
        },
        {
          "articolo": "Articolo placeholder: ID_NON_DISPONIBILE",
          "costoTotale": 6062604.23000007
        },
        {
          "articolo": "CENTRALINA MCX08M2 DANFOSS",
          "costoTotale": 37814.88
        }
      ],
      "mismatch_extra": [
        {
          "fornitore": "SALDOGAS SRL",
          "articolo": "GAS FREON SOLSTICE N40 R448A",
          "costoTotaleAcquisto": 554029.2
        },
        {
          "fornitore": "MORELLI SPA",
          "articolo": "Articolo placeholder: ID_NON_DISPONIBILE",
          "costoTotaleAcquisto": 1686526.5499999977
        },
        {
          "fornitore": "OFFICINE MARIO DORIN SPA",
          "articolo": "Articolo placeholder: ID_NON_DISPONIBILE",
          "costoTotaleAcquisto": 245062.48999999985
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-46-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 5 articoli con il costo totale di acquisto pi\u00f9 basso?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)\nRETURN a.descrizione AS articolo, sum(dr.importo) AS costoTotale\nORDER BY costoTotale ASC\nLIMIT 5",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) RETURN a.descrizione AS articolo, sum(dr.importo) AS costoTotale ORDER BY costoTotale ASC LIMIT 5",
      "time_total": 32.07479538116604,
      "time_generation": 26.97071017837152,
      "time_db": 0.219449067953974,
      "time_synthesis": 3.536584404297173,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-47-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore ci vende la gamma pi\u00f9 ampia di articoli unici?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nWITH f, collect(distinct doc.documentoId) AS documentoIds\nRETURN f.ragioneSociale AS fornitore, size(documentoIds) AS numArticoli\nORDER BY numArticoli DESC\nLIMIT 1",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS varietaProdotti ORDER BY varietaProdotti DESC LIMIT 1",
      "time_total": 39.72703527705744,
      "time_generation": 33.47990649100393,
      "time_db": 0.1474008052609861,
      "time_synthesis": 4.149967402219772,
      "jaccard_index": 0.0,
      "query_similarity": 0.42061855670103093,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "fornitore": "MORELLI SPA",
          "varietaProdotti": 383
        }
      ],
      "mismatch_extra": [
        {
          "fornitore": "MORELLI SPA",
          "numArticoli": 2832
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-48-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore ci vende la gamma meno ampia di articoli unici?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(rd:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH f, count(DISTINCT a) AS num_distinct_articoli\nORDER BY num_distinct_articoli ASC\nLIMIT 1\nRETURN f.ragioneSociale AS supplier_name",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS varietaProdotti ORDER BY varietaProdotti ASC LIMIT 1",
      "time_total": 55.529047465417534,
      "time_generation": 47.121014568023384,
      "time_db": 0.2514159749262035,
      "time_synthesis": 5.649325015954673,
      "jaccard_index": 0.0,
      "query_similarity": 0.04554079696394687,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "fornitore": "10GTEK TRANSCEIVERS CO.LIMITED",
          "varietaProdotti": 1
        }
      ],
      "mismatch_extra": [
        {
          "supplier_name": "AMAZON EU S.A.R.L. 3 SUCURSAL EN ESPANA"
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-49-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ordina le aziende in base al numero totale di documenti di vendita emessi.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nWITH f, count(doc) AS totaleDocumenti\nRETURN f.ragioneSociale AS ragioneSociale, totaleDocumenti AS totaleDocumenti\nORDER BY totaleDocumenti DESC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento) RETURN d.dittaId AS ditta, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC",
      "time_total": 35.70441525103524,
      "time_generation": 24.206576057709754,
      "time_db": 0.23710527131333947,
      "time_synthesis": 5.055476268753409,
      "jaccard_index": 0.0,
      "query_similarity": 0.5378151260504201,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "ditta": "4",
          "numeroDocumenti": 206
        },
        {
          "ditta": "3",
          "numeroDocumenti": 232
        },
        {
          "ditta": "1",
          "numeroDocumenti": 1550
        }
      ],
      "mismatch_extra": [
        {
          "ragioneSociale": "TONITRUS GMBH",
          "totaleDocumenti": 1
        },
        {
          "ragioneSociale": "COM-FOUR VETRIEBS GMBH",
          "totaleDocumenti": 1
        },
        {
          "ragioneSociale": "NING BO BI LUO KE GUO JI MAO YI YOU XIAN GONG SI",
          "totaleDocumenti": 2
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-50-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fornitore con il maggior numero di articoli forniti?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nRETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS numeroArticoli\nORDER BY numeroArticoli DESC\nLIMIT 1",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS numeroArticoli ORDER BY numeroArticoli DESC LIMIT 1",
      "time_total": 31.106782269198447,
      "time_generation": 27.02358979266137,
      "time_db": 0.16979207191616297,
      "time_synthesis": 2.155876380391419,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-51-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi sono i principali fornitori degli articoli venduti al nostro miglior cliente?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nWITH c, sum(dr.importo) AS fatturatoCliente \nORDER BY fatturatoCliente DESC \nLIMIT 1 \nWITH c AS topCliente \nMATCH (topCliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWITH topCliente, collect(DISTINCT a) AS articoliDelTopCliente \nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE a IN articoliDelTopCliente \nRETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS numeroArticoliDiversiForniti \nORDER BY numeroArticoliDiversiForniti DESC",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 1 WITH c AS topCliente MATCH (topCliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WITH topCliente, collect(DISTINCT a) AS articoliDelTopCliente MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE a IN articoliDelTopCliente RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS numeroArticoliDiversiForniti ORDER BY numeroArticoliDiversiForniti DESC",
      "time_total": 58.12006577057764,
      "time_generation": 50.097899231128395,
      "time_db": 0.6563926092348993,
      "time_synthesis": 5.698284420184791,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-52-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono le famiglie di prodotti vendute sia dalla ditta '1' che dalla ditta '2'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (fam1:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta {dittaId: '1'}) \nWITH collect(DISTINCT fam1) AS famiglieDitta1 \n\nMATCH (fam2:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta {dittaId: '2'}) \nWHERE fam2 IN famiglieDitta1 \nRETURN DISTINCT fam2.nome AS famigliaComune ORDER BY famigliaComune",
      "expected_cypher": "MATCH (fam1:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta {dittaId: '1'}) WITH collect(DISTINCT fam1) AS famiglieDitta1 MATCH (fam2:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta {dittaId: '2'}) WHERE fam2 IN famiglieDitta1 RETURN DISTINCT fam2.nome AS famigliaComune ORDER BY famigliaComune",
      "time_total": 52.1038851197809,
      "time_generation": 44.99758036900312,
      "time_db": 2.2101036948151886,
      "time_synthesis": 2.8666780390776694,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-53-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami 5 prodotti che abbiamo acquistato ma mai venduto.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)\nWHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: 'Fatturato'})\nRETURN DISTINCT a.descrizione AS prodottoMaiVenduto\nORDER BY prodottoMaiVenduto\nLIMIT 5",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WITH DISTINCT a WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: 'Fatturato'}) RETURN a.descrizione AS prodottoMaiVenduto LIMIT 5",
      "time_total": 35.92166770482436,
      "time_generation": 29.726366725284606,
      "time_db": 0.22741320496425033,
      "time_synthesis": 3.6727279238402843,
      "jaccard_index": 0.0,
      "query_similarity": 0.9023941068139963,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "prodottoMaiVenduto": "cap de cddc"
        },
        {
          "prodottoMaiVenduto": "SERB.ACC A/REFR.LT1000"
        },
        {
          "prodottoMaiVenduto": "COMPR.ERM.SCROLL ZB38KCE"
        }
      ],
      "mismatch_extra": [
        {
          "prodottoMaiVenduto": "ACCESSORIO-P5"
        },
        {
          "prodottoMaiVenduto": "AEROEVAPORATORE HDI 406 E 3"
        },
        {
          "prodottoMaiVenduto": "ADBLUE CISTERNA DA 1000LT"
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-54-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il fatturato totale per ogni mese dell'anno corrente della ditta '1'.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE date(doc.dataEmissione).year = date().year AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN date(doc.dataEmissione).month AS mese, sum(dr.importo) AS fatturatoMensile ORDER BY mese ASC",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE date(doc.dataEmissione).year = date().year AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN date(doc.dataEmissione).month AS mese, sum(dr.importo) AS fatturatoMensile ORDER BY mese ASC",
      "time_total": 37.37006414262578,
      "time_generation": 32.03235530201346,
      "time_db": 0.035935111809521914,
      "time_synthesis": 3.5988954808562994,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-55-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Confronta il fatturato totale del 2024 con quello del 2023.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nAND doc.dataEmissione.year IN [2023, 2024] \nRETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoTotale ORDER BY anno",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year IN [2023, 2024] RETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoTotale ORDER BY anno",
      "time_total": 26.407275354955345,
      "time_generation": 21.44627257063985,
      "time_db": 0.40908478992059827,
      "time_synthesis": 2.916791645810008,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-56-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore \u00e8 stato il pi\u00f9 attivo (per valore di acquisto) nell'ultimo trimestre?",
      "success": true,
      "error": null,
      "generated_cypher": "WITH date() - duration({months: 3}) AS dataInizioTrimestre \nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE doc.dataEmissione >= dataInizioTrimestre \nRETURN gf.ragioneSociale AS fornitore, sum(dr.importo) AS totaleAcquistato \nORDER BY totaleAcquistato DESC \nLIMIT 1",
      "expected_cypher": "WITH date() - duration({months: 3}) AS dataInizioTrimestre MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE doc.dataEmissione >= dataInizioTrimestre RETURN gf.ragioneSociale AS fornitore, sum(dr.importo) AS totaleAcquistato ORDER BY totaleAcquistato DESC LIMIT 1",
      "time_total": 32.03206898132339,
      "time_generation": 28.920257578138262,
      "time_db": 0.009137610904872417,
      "time_synthesis": 1.6635533310472965,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-57-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i clienti il cui primo documento di vendita \u00e8 stato emesso negli ultimi 6 mesi.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento) WITH c, min(doc.dataEmissione) AS primoAcquisto WHERE primoAcquisto >= date() - duration({months: 6}) RETURN c.name AS clienteRecente, primoAcquisto ORDER BY primoAcquisto DESC",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento) WITH c, min(doc.dataEmissione) AS primoAcquisto WHERE primoAcquisto >= date() - duration({months: 6}) RETURN c.name AS clienteRecente, primoAcquisto ORDER BY primoAcquisto DESC",
      "time_total": 27.970104083884507,
      "time_generation": 24.89664509287104,
      "time_db": 0.08388889487832785,
      "time_synthesis": 1.5717636672779918,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-58-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ci sono aziende che non hanno registrato alcun fatturato?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)\nWHERE NOT (d)-[:APPARTIENE_A]->(:Cliente)-[:HA_RICEVUTO]->(:Documento {tipoOriginale: 'Fatturato'})\nRETURN DISTINCT d.dittaId AS ditta\nORDER BY ditta\nLIMIT 10",
      "expected_cypher": "MATCH (d:Ditta) WHERE NOT (d)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Fatturato'}) RETURN d.dittaId AS dittaSenzaFatturato",
      "time_total": 33.2714548073709,
      "time_generation": 29.84681106870994,
      "time_db": 0.159609102178365,
      "time_synthesis": 1.8597250799648464,
      "jaccard_index": 0.0,
      "query_similarity": 0.7590027700831025,
      "specialist": "DITTE_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [],
      "mismatch_extra": [
        {
          "ditta": "4"
        },
        {
          "ditta": "2"
        },
        {
          "ditta": "1"
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-59-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ultimo documento emesso nel 2024",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento) WHERE doc.dataEmissione.year = 2024 WITH doc ORDER BY doc.dataEmissione DESC LIMIT 1 OPTIONAL MATCH (doc)<-[:HA_RICEVUTO]-(c:Cliente) OPTIONAL MATCH (doc)<-[:HA_EMESSO]-(f:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore) RETURN doc.documentoId AS UltimodocumentoId,  doc.dataEmissione AS DataEmissione, CASE WHEN gf IS NOT NULL THEN gf.ragioneSociale ELSE 'Nostra Azienda (Vendita)' END AS EmessoDa, CASE WHEN c IS NOT NULL THEN c.name ELSE 'Nostra Azienda (Acquisto)' END AS EmessoA",
      "expected_cypher": "MATCH (doc:Documento) WHERE doc.dataEmissione.year = 2024 WITH doc ORDER BY doc.dataEmissione DESC LIMIT 1 OPTIONAL MATCH (doc)<-[:HA_RICEVUTO]-(c:Cliente) OPTIONAL MATCH (doc)<-[:HA_EMESSO]-(f:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore) RETURN doc.documentoId AS UltimodocumentoId,  doc.dataEmissione AS DataEmissione, CASE WHEN gf IS NOT NULL THEN gf.ragioneSociale ELSE 'Nostra Azienda (Vendita)' END AS EmessoDa, CASE WHEN c IS NOT NULL THEN c.name ELSE 'Nostra Azienda (Acquisto)' END AS EmessoA",
      "time_total": 34.88620586367324,
      "time_generation": 28.681072550825775,
      "time_db": 0.054926134180277586,
      "time_synthesis": 3.8029923173598945,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-60-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Trova i fornitori che non ci hanno mai venduto prodotti della famiglia 'CENTRALI FRIGO'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE NOT EXISTS { MATCH (a)<-[:INCLUSA_IN]-(:Famiglia {nome: 'CENTRALI FRIGO'}) }\nRETURN DISTINCT f.ragioneSociale AS fornitore\nORDER BY fornitore\nLIMIT 10",
      "expected_cypher": "MATCH (fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' WITH fam MATCH (gf:GruppoFornitore) WHERE NOT (gf)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam) RETURN gf.ragioneSociale AS fornitore",
      "time_total": 42.57084472896531,
      "time_generation": 32.826157066971064,
      "time_db": 0.22762420773506165,
      "time_synthesis": 3.729984513949603,
      "jaccard_index": 0.002631578947368421,
      "query_similarity": 0.06482982171799027,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "fornitore": "ACQUA DRINK SERVICE S.R.L."
        },
        {
          "fornitore": "EFFE SRL"
        },
        {
          "fornitore": "FRIGOPANNELLI SRL"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-61-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali clienti appartengono esclusivamente all'azienda '1' e non ad altre?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:APPARTIENE_A]->(d:Ditta)\nWHERE d.dittaId = '1'\nRETURN DISTINCT c.name AS clienteEsclusivo\nORDER BY clienteEsclusivo\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:APPARTIENE_A]->(d:Ditta) WITH c, collect(d.dittaId) AS ditte WHERE size(ditte) = 1 AND ditte[0] = '1' RETURN c.name AS clienteEsclusivo",
      "time_total": 22.528979730792344,
      "time_generation": 17.10725244600326,
      "time_db": 0.12185552017763257,
      "time_synthesis": 3.743736886419356,
      "jaccard_index": 0.005305039787798408,
      "query_similarity": 0.6488294314381271,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "clienteEsclusivo": "SEMEXO OHG"
        },
        {
          "clienteEsclusivo": "RIST.BORSALINO DUE SNC"
        },
        {
          "clienteEsclusivo": "IM.PE SRL"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-62-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per ogni famiglia di prodotto, chi \u00e8 il cliente che ha generato il fatturato maggiore?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nRETURN c.name AS cliente, fatturato AS revenue",
      "expected_cypher": "MATCH (fam:Famiglia)<-[:INCLUSA_IN]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(c:Cliente) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH fam, c, sum(dr.importo) AS fatturato ORDER BY fam.nome, fatturato DESC WITH fam, collect({cliente: c.name, fatturato: fatturato}) AS clientiOrdinati RETURN fam.nome AS famiglia, clientiOrdinati[0].cliente AS topCliente, clientiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 61.46014697384089,
      "time_generation": 56.62488752277568,
      "time_db": 0.6143422001041472,
      "time_synthesis": 2.935324788093567,
      "jaccard_index": 0.0,
      "query_similarity": 0.3962765957446808,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "famiglia": "VARIATORE",
          "topCliente": "GMF SRL UNIPERSONALE",
          "fatturatoMassimo": 2501148.450000001
        },
        {
          "famiglia": "CONDENSATORI",
          "topCliente": "GMF SRL UNIPERSONALE",
          "fatturatoMassimo": 2501148.450000001
        },
        {
          "famiglia": "TERMOSTATI",
          "topCliente": "GMF SRL UNIPERSONALE",
          "fatturatoMassimo": 2501148.450000001
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "MAGESTIC SRL",
          "revenue": 64244.23000000001
        },
        {
          "cliente": "CESMAR SAS",
          "revenue": 15033.0
        },
        {
          "cliente": "MORGAN SRLS",
          "revenue": 90.0
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-63-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Calcola il rapporto tra costo totale e fatturato totale per il prodotto 'GAS FREON SOLSTICE N40 R448A'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a'\nOPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) \nWITH a, sum(dr_acq.importo) AS costoTotale\nOPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento {tipoValore: 'Fatturato'})<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente) \nWHERE dr_ven.importo > 0\nWITH costoTotale, sum(dr_ven.importo) AS fatturatoTotale\nRETURN costoTotale, fatturatoTotale, CASE WHEN costoTotale <> 0 THEN fatturatoTotale / costoTotale ELSE null END AS rapporto",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WITH a, sum(dr_acq.importo) AS costoTotale OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento {tipoValore: 'Fatturato'})<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente) WHERE dr_ven.importo > 0 WITH costoTotale, sum(dr_ven.importo) AS fatturatoTotale RETURN  costoTotale, fatturatoTotale, CASE WHEN costoTotale <> 0 THEN fatturatoTotale / costoTotale ELSE null END AS rapporto",
      "time_total": 59.77027618326247,
      "time_generation": 54.89149197284132,
      "time_db": 0.24101804289966822,
      "time_synthesis": 2.825074682943523,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-64-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale provincia ha generato il volume di fatturato pi\u00f9 alto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo)\nMATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN l.provincia AS provincia, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN l.provincia AS provincia, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 42.44391388213262,
      "time_generation": 36.10384390410036,
      "time_db": 0.6624488369561732,
      "time_synthesis": 4.012757521122694,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-65-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale provincia ha generato il volume di fatturato pi\u00f9 basso?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) \nMATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN l.provincia AS provincia, sum(dr.importo) AS fatturatoTotale \nORDER BY fatturatoTotale ASC \nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN l.provincia AS provincia, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale ASC LIMIT 1",
      "time_total": 42.24087375262752,
      "time_generation": 36.099490482360125,
      "time_db": 0.47868837835267186,
      "time_synthesis": 2.6316955536603928,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-66-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Lista dei clienti il cui fatturato totale \u00e8 superiore al fatturato medio di tutti i clienti.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH count(DISTINCT c) AS totalCustomers, sum(dr.importo) AS totalRevenue\nWITH CASE WHEN totalCustomers = 0 THEN null ELSE totalRevenue / totalCustomers END AS avgRevenue\nWHERE avgRevenue IS NOT NULL\nMATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS customerRevenue, avgRevenue\nWHERE customerRevenue > avgRevenue\nRETURN c.name AS cliente, customerRevenue\nORDER BY customerRevenue DESC",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH count(DISTINCT c) AS totalCustomers, sum(dr.importo) AS totalRevenue WITH CASE WHEN totalCustomers = 0 THEN null ELSE totalRevenue / totalCustomers END AS avgRevenue WHERE avgRevenue IS NOT NULL MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS customerRevenue, avgRevenue WHERE customerRevenue > avgRevenue RETURN c.name AS cliente, customerRevenue ORDER BY customerRevenue DESC",
      "time_total": 34.94456230616197,
      "time_generation": 30.30699761491269,
      "time_db": 0.5987033769488335,
      "time_synthesis": 2.3741671200841665,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-67-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il numero di documenti per ciascun tipo (codice).",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType)\nRETURN dt.codice AS tipo, count(doc) AS numeroDocumenti\nORDER BY numeroDocumenti DESC",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType) RETURN dt.codice AS tipoDocumento, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC",
      "time_total": 30.244777280837297,
      "time_generation": 22.621578907128423,
      "time_db": 0.1309338342398405,
      "time_synthesis": 5.820728508289903,
      "jaccard_index": 1.0,
      "query_similarity": 0.967032967032967,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-68-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato totale associato ai documenti di tipo 'FVC'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'})\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS fatturatoFVC",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoFVC",
      "time_total": 33.80466529307887,
      "time_generation": 29.430355565156788,
      "time_db": 0.2637086231261492,
      "time_synthesis": 1.5667434139177203,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-69-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale cliente ha ricevuto il maggior numero di note di credito (codice 'NCC')?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'NCC'})\nRETURN c.name AS cliente, count(doc) AS numeroNoteCredito\nORDER BY numeroNoteCredito DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'NCC'}) RETURN c.name AS cliente, count(doc) AS numeroNoteCredito ORDER BY numeroNoteCredito DESC LIMIT 1",
      "time_total": 32.18861173512414,
      "time_generation": 26.135947245173156,
      "time_db": 0.011521582957357168,
      "time_synthesis": 3.943567219655961,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-70-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Calcola il valore medio di un documento per ciascun tipo (considerando solo il fatturato).",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType)\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH dt, doc, sum(dr.importo) AS valoreDocumento\nRETURN dt.nome AS tipoDocumento, avg(valoreDocumento) AS valoreMedio\nORDER BY valoreMedio DESC",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH dt, doc, sum(dr.importo) AS valoreDocumento RETURN dt.codice AS tipoDocumento, avg(valoreDocumento) AS valoreMedio ORDER BY valoreMedio DESC",
      "time_total": 40.23266995372251,
      "time_generation": 32.08065714733675,
      "time_db": 0.3507000179961324,
      "time_synthesis": 2.1466901525855064,
      "jaccard_index": 0.0,
      "query_similarity": 0.9863481228668942,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "tipoDocumento": "FVC",
          "valoreMedio": 2511.581093866322
        },
        {
          "tipoDocumento": "NDC",
          "valoreMedio": 6835.246666666666
        },
        {
          "tipoDocumento": "NCC",
          "valoreMedio": 2662.121951219513
        }
      ],
      "mismatch_extra": [
        {
          "tipoDocumento": "Nota Debito Cliente",
          "valoreMedio": 6835.246666666666
        },
        {
          "tipoDocumento": "Fattura Cliente",
          "valoreMedio": 2511.581093866322
        },
        {
          "tipoDocumento": "Nota Credito Cliente",
          "valoreMedio": 2662.121951219513
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-71-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il cliente con il fatturato pi\u00f9 alto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 40.57643478689715,
      "time_generation": 31.210668910760432,
      "time_db": 0.4844264816492796,
      "time_synthesis": 1.7474892321042717,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-72-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 clienti situati a Perugia",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.localita)) = 'perugia' RETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 5",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.localita)) = 'perugia' RETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 5",
      "time_total": 20.17157504009083,
      "time_generation": 12.395945858210325,
      "time_db": 0.02052787784487009,
      "time_synthesis": 2.7251750989817083,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-73-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 5 prodotti pi\u00f9 popolari in termini di quantit\u00e0 venduta",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nRETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 5",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 5",
      "time_total": 30.30553713813424,
      "time_generation": 25.05866914615035,
      "time_db": 0.5342996069230139,
      "time_synthesis": 2.8971311398781836,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-74-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Dimmi il fatturato di ciascuna azienda.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 37.16277396120131,
      "time_generation": 27.67015068884939,
      "time_db": 0.7914115181192756,
      "time_synthesis": 4.027086660731584,
      "jaccard_index": 1.0,
      "query_similarity": 0.9980353634577603,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-75-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanto ho speso per acquistare il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)\nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a'\nRETURN sum(dr.importo) AS costoTotaleAcquisto",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' RETURN sum(dr.importo) AS costoTotaleAcquisto",
      "time_total": 39.7071394380182,
      "time_generation": 33.68269616086036,
      "time_db": 0.15140134189277887,
      "time_synthesis": 1.7339321379549801,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-76-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanto ho guadagnato vendendo il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleVenduto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS totaleVenduto",
      "time_total": 36.701621828600764,
      "time_generation": 31.931103537324816,
      "time_db": 0.5005690380930901,
      "time_synthesis": 2.868952098302543,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-77-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali aziende vendono prodotti della famiglia 'CENTRALI FRIGO'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' RETURN DISTINCT d.dittaId AS ditta ORDER BY ditta",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' RETURN DISTINCT d.dittaId AS ditta ORDER BY ditta",
      "time_total": 29.28004755405709,
      "time_generation": 21.976474658120424,
      "time_db": 0.5112426178529859,
      "time_synthesis": 2.5767796053551137,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-78-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo medio per riga documento nelle fatture di vendita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN avg(dr.importo) AS importoMedioRiga",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN avg(dr.importo) AS importoMedioRiga",
      "time_total": 44.37246376089752,
      "time_generation": 35.58067543618381,
      "time_db": 0.3070070957764983,
      "time_synthesis": 2.360874488018453,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-79-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per ogni azienda, classifica il suo fatturato totale come 'Alto' se supera i 10 milioni, 'Medio' se \u00e8 tra 1 e 10 milioni, e 'Basso' altrimenti.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH d, sum(dr.importo) AS fatturatoTotale\nRETURN d.dittaId AS ditta, fatturatoTotale,\n       CASE WHEN fatturatoTotale > 10000000 THEN 'Alto'\n            WHEN fatturatoTotale > 1000000 THEN 'Medio'\n            ELSE 'Basso' END AS categoriaFatturato\nORDER BY fatturatoTotale DESC;",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, sum(dr.importo) AS fatturatoTotale RETURN d.dittaId AS ditta, fatturatoTotale, CASE WHEN fatturatoTotale > 10000000 THEN 'Alto' WHEN fatturatoTotale > 1000000 THEN 'Medio' ELSE 'Basso' END AS categoriaFatturato",
      "time_total": 37.965498879086226,
      "time_generation": 28.197344595566392,
      "time_db": 0.5584521950222552,
      "time_synthesis": 4.138187859207392,
      "jaccard_index": 1.0,
      "query_similarity": 0.9609079445145019,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-80-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il primo e l'ultimo documento di vendita mai registrato per il cliente 'ACME SRL'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente {name: 'ACME SRL'})-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType)\nWITH doc ORDER BY doc.dataEmissione DESC\nRETURN DISTINCT doc.documentoId AS documento, doc.dataEmissione AS dataEmissione LIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento) WHERE toLower(trim(c.name)) = 'acme srl' RETURN min(doc.dataEmissione) AS primoDocumento, max(doc.dataEmissione) AS ultimoDocumento",
      "time_total": 47.08103497931734,
      "time_generation": 28.97911432106048,
      "time_db": 9.996398382820189,
      "time_synthesis": 1.9141262993216515,
      "jaccard_index": 0.0,
      "query_similarity": 0.2623762376237624,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "primoDocumento": null,
          "ultimoDocumento": null
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-81-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la media del fatturato mensile per il cliente 'ACME SRL' nel 2024?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE toLower(trim(c.name)) = 'acme srl' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024\nWITH date(doc.dataEmissione).month AS mese, sum(dr.importo) AS fatturatoMensile \nRETURN avg(fatturatoMensile) AS mediaFatturatoMensile",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE toLower(trim(c.name)) = 'l\\'abbondanza srl' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024 WITH date(doc.dataEmissione).month AS mese, sum(dr.importo) AS fatturatoMensile RETURN avg(fatturatoMensile) AS mediaFatturatoMensile",
      "time_total": 32.47868116525933,
      "time_generation": 24.096232431009412,
      "time_db": 0.01527393702417612,
      "time_synthesis": 2.2348830099217594,
      "jaccard_index": 0.0,
      "query_similarity": 0.9757489300998573,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "mediaFatturatoMensile": 170779.88249999998
        }
      ],
      "mismatch_extra": [
        {
          "mediaFatturatoMensile": null
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-82-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per i primi 3 clienti per fatturato, mostra il loro prodotto pi\u00f9 acquistato per valore.",
      "success": false,
      "error": "API error 500: {'detail': 'Errore durante l\\'elaborazione: {code: Neo.ClientError.Statement.SyntaxError} {message: Can\\'t use aggregate functions inside of aggregate functions. (line 3, column 52 (off",
      "generated_cypher": null,
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 3 MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr2.tipoValore = 'Fatturato' AND dr2.importo > 0 WITH c, a, sum(dr2.importo) AS valoreProdotto ORDER BY c.name, valoreProdotto DESC WITH c, head(collect({prodotto: a.descrizione, valore: valoreProdotto})) AS topProdotto RETURN c.name AS cliente, topProdotto.prodotto AS prodottoTop, topProdotto.valore AS valoreTop ORDER BY c.name",
      "time_total": null,
      "time_generation": null,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": null,
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": 2
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-83-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali clienti hanno effettuato ordini ma non hanno ancora ricevuto una fattura?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'}) \nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento {tipoValore: 'Ordinato'})\nWITH c, sum(dr.importo) AS valoreOrdinato\nMATCH (c)-[:HA_RICEVUTO]->(doc_fat:Documento)-[:IS_TYPE]->(dt_fat:DocType {codice: 'Fatturato'}) \nWHERE NOT (doc_fat)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Ordinato', importo: valoreOrdinato})\nRETURN c.name AS cliente\nORDER BY cliente\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Ordinato'}) WITH DISTINCT c MATCH (c) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Fatturato'}) RETURN c.name AS clienteSenzaFattura",
      "time_total": 47.75968021294102,
      "time_generation": 41.648267635609955,
      "time_db": 0.6717872470617294,
      "time_synthesis": 3.9789076247252524,
      "jaccard_index": 0.0,
      "query_similarity": 0.5690834473324213,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "clienteSenzaFattura": "HONG KONG UGREEN LIMITED"
        },
        {
          "clienteSenzaFattura": "MACELLERIA SAN SECONDO"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-84-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il fornitore principale per ogni famiglia di prodotto, in base al valore acquistato?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Famiglia)-[:INCLUSA_IN]->(sf:Sottofamiglia)-[:APPARTIENE_A]->(a:Articolo)\nWITH f, collect(DISTINCT a) AS articoli\nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nWHERE a IN articoli\nWITH f, sum(dr.importo) AS totaleAcquistato, collect(DISTINCT gf.ragioneSociale) AS fornitori\nORDER BY totaleAcquistato DESC\nRETURN f.nome AS famiglia, fornitori[0] AS fornitorePrincipale\nLIMIT 10",
      "expected_cypher": "MATCH (fam:Famiglia)<-[:INCLUSA_IN]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore) WITH fam, gf, sum(dr.importo) AS valoreAcquistato ORDER BY fam.nome, valoreAcquistato DESC WITH fam, collect({fornitore: gf.ragioneSociale, valore: valoreAcquistato})[0] AS fornitoreTop RETURN fam.nome AS famiglia, fornitoreTop.fornitore AS fornitorePrincipale",
      "time_total": 71.26076426031068,
      "time_generation": 63.22588573768735,
      "time_db": 0.23923368519172072,
      "time_synthesis": 2.048839241731912,
      "jaccard_index": 0.0,
      "query_similarity": 0.2358974358974359,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "famiglia": "FRONTALE",
          "fornitorePrincipale": "SALDOGAS SRL"
        },
        {
          "famiglia": "RADIALI",
          "fornitorePrincipale": "SALDOGAS SRL"
        },
        {
          "famiglia": "TERMOMETRI",
          "fornitorePrincipale": "SALDOGAS SRL"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-85-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore totale degli ordini in sospeso (ordinati ma non fatturati)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Ordinato' AND NOT doc.dataEmissione IS NOT NULL\nRETURN sum(dr.importo) AS totaleOrdiniPendenti",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Ordinato' WITH c, doc, sum(dr.importo) AS valoreOrdinato WHERE NOT (doc)<-[:CONTIENE_RIGA]-(:RigaDocumento {tipoValore:'Fatturato'}) RETURN sum(valoreOrdinato) AS totaleOrdiniSospesi",
      "time_total": 46.59607004513964,
      "time_generation": 43.010076072998345,
      "time_db": 0.1631659548729658,
      "time_synthesis": 1.84450988098979,
      "jaccard_index": 0.0,
      "query_similarity": 0.5161290322580645,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "totaleOrdiniSospesi": 2376823.7100000004
        }
      ],
      "mismatch_extra": [
        {
          "totaleOrdiniPendenti": 0
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-86-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i clienti che acquistano pi\u00f9 di 10 articoli unici diversi.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH c, count(DISTINCT a) AS numeroArticoliUnici\nWHERE numeroArticoliUnici > 10\nRETURN c.name AS cliente, numeroArticoliUnici\nORDER BY numeroArticoliUnici DESC",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WITH c, count(DISTINCT a) AS numeroArticoliUnici WHERE numeroArticoliUnici > 10 RETURN c.name AS cliente, numeroArticoliUnici ORDER BY numeroArticoliUnici DESC",
      "time_total": 41.123406587168574,
      "time_generation": 34.437901727855206,
      "time_db": 0.42065411899238825,
      "time_synthesis": 4.821910297032446,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-87-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per il prodotto pi\u00f9 venduto per quantit\u00e0, qual \u00e8 il suo costo medio di acquisto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWITH a, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 1 \nMATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) \nRETURN a.descrizione AS prodotto, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedioUnitario",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WITH a, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 1 MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) RETURN a.descrizione AS prodotto, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedioUnitario",
      "time_total": 48.56041643023491,
      "time_generation": 44.767205112148076,
      "time_db": 0.6261576912365854,
      "time_synthesis": 1.8968116180039942,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-88-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i fornitori che trattano solo prodotti di una singola famiglia.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) \nWITH gf, count(DISTINCT fam) AS numeroFamiglie \nWHERE numeroFamiglie = 1 \nRETURN DISTINCT gf.ragioneSociale AS fornitoreMonoFamiglia",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WITH gf, count(DISTINCT fam) AS numeroFamiglie WHERE numeroFamiglie = 1 RETURN gf.ragioneSociale AS fornitoreMonoFamiglia",
      "time_total": 31.938823950011283,
      "time_generation": 27.48890228010714,
      "time_db": 0.6656336430460215,
      "time_synthesis": 2.166088063735515,
      "jaccard_index": 1.0,
      "query_similarity": 0.9870503597122302,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-89-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la percentuale di fatturato generata dai clienti nella regione 'Umbria' sul totale?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo),(c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nWITH sum(dr.importo) AS totaleFatturato,  \n     sum(CASE WHEN toLower(trim(l.regione)) = 'umbria' THEN dr.importo ELSE 0 END) AS fatturatoUmbria \nRETURN CASE WHEN totaleFatturato = 0 THEN 0.0 ELSE (fatturatoUmbria * 100.0 / totaleFatturato) END AS percentualeUmbria",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo),(c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH sum(dr.importo) AS totaleFatturato,  sum(CASE WHEN toLower(trim(l.regione)) = 'umbria' THEN dr.importo ELSE 0 END) AS fatturatoUmbria RETURN CASE WHEN totaleFatturato = 0 THEN 0.0 ELSE (fatturatoUmbria * 100.0 / totaleFatturato) END AS percentualeUmbria",
      "time_total": 37.81953155994415,
      "time_generation": 33.323116269893944,
      "time_db": 0.588185474742204,
      "time_synthesis": 1.7761956811882555,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-90-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Trova il cliente con il valore medio degli ordini pi\u00f9 alto.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS valoreOrdine RETURN c.name AS cliente, avg(valoreOrdine) AS valoreMedioOrdine ORDER BY valoreMedioOrdine DESC LIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, doc, sum(dr.importo) AS valoreOrdine RETURN c.name AS cliente, avg(valoreOrdine) AS valoreMedioOrdine ORDER BY valoreMedioOrdine DESC LIMIT 1",
      "time_total": 44.73879654798657,
      "time_generation": 37.96279128920287,
      "time_db": 0.5629282249137759,
      "time_synthesis": 3.7541307169012725,
      "jaccard_index": 0.0,
      "query_similarity": 0.9912739965095986,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "cliente": "CREDEMLEASING SPA",
          "valoreMedioOrdine": 201600.0
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "I.G.E.S. S.R.L.",
          "valoreMedioOrdine": 4753375.079999995
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-91-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 3 mesi con il maggior numero di documenti di acquisto registrati.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nRETURN doc.dataEmissione.year AS anno, doc.dataEmissione.month AS mese, count(doc) AS numeroDocumenti\nORDER BY numeroDocumenti DESC\nLIMIT 3",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(doc:Documento) RETURN doc.dataEmissione.year AS anno, doc.dataEmissione.month AS mese, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC LIMIT 3",
      "time_total": 26.62961680907756,
      "time_generation": 21.893219290766865,
      "time_db": 0.06747942790389061,
      "time_synthesis": 3.070781318936497,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-92-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ci sono prodotti venduti a un prezzo inferiore al loro costo medio di acquisto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo) \nOPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) \nWITH a, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedio \n\nOPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente) \nWHERE dr_ven.tipoValore = 'Fatturato' AND dr_ven.importo > 0 \nWITH a, costoMedio, avg(CASE WHEN dr_ven.quantita = 0 OR dr_ven.quantita IS NULL THEN null ELSE dr_ven.importo / dr_ven.quantita END) AS prezzoMedioVendita \n\nWHERE prezzoMedioVendita < costoMedio \nRETURN a.descrizione AS prodottoInPerdita",
      "expected_cypher": "MATCH (a:Articolo) OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WITH a, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedio OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente) WHERE dr_ven.tipoValore = 'Fatturato' AND dr_ven.importo > 0 WITH a, costoMedio, avg(CASE WHEN dr_ven.quantita = 0 OR dr_ven.quantita IS NULL THEN null ELSE dr_ven.importo / dr_ven.quantita END) AS prezzoMedioVendita WHERE prezzoMedioVendita < costoMedio RETURN a.descrizione AS prodottoInPerdita",
      "time_total": 59.04902858193964,
      "time_generation": 51.83432548120618,
      "time_db": 1.0120340390130877,
      "time_synthesis": 4.076046034228057,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-93-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale tipo di documento (codice) \u00e8 pi\u00f9 frequentemente associato al ciclo di acquisto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType)\nRETURN dt.codice AS tipoDocumento, count(doc) AS frequenza\nORDER BY frequenza DESC\nLIMIT 1",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) RETURN dt.codice AS tipoDocumento, count(doc) AS frequenza ORDER BY frequenza DESC LIMIT 1",
      "time_total": 34.91441989969462,
      "time_generation": 29.998362904880196,
      "time_db": 0.05892761517316103,
      "time_synthesis": 2.3997363201342523,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-94-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i fornitori situati in un luogo dove non abbiamo clienti.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore)-[:SI_TROVA_A]->(lf:Luogo) \nWHERE NOT EXISTS { MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo {localita: lf.localita}) } \nRETURN DISTINCT f.ragioneSociale AS fornitore ORDER BY fornitore",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore)-[:SI_TROVA_A]->(lf:Luogo) WHERE NOT EXISTS { MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo {localita: lf.localita}) } RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER BY fornitore",
      "time_total": 27.638586127664894,
      "time_generation": 20.821596505120397,
      "time_db": 0.43671613093465567,
      "time_synthesis": 3.752572559285909,
      "jaccard_index": 1.0,
      "query_similarity": 0.9979381443298969,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-95-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quante note di credito clienti (NCC) abbiamo emesso in totale?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'NCC'})\nRETURN count(doc) AS numeroNoteCredito",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'NCC'}) RETURN count(doc) AS numeroNoteCredito",
      "time_total": 28.93745307903737,
      "time_generation": 25.785224152263254,
      "time_db": 0.026978460140526295,
      "time_synthesis": 1.6512773898430169,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-96-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami tutti gli ordini fornitori (OF) per maggio 2024.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OF'}) \nWHERE doc.dataEmissione.year = 2024 AND doc.dataEmissione.month = 5 \nRETURN doc.documentoId AS ordine\nORDER BY ordine\nLIMIT 10",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OF'}) WHERE doc.dataEmissione.year = 2024 AND doc.dataEmissione.month = 5 RETURN doc.documentoId AS ordine",
      "time_total": 32.57723935879767,
      "time_generation": 27.294292232953012,
      "time_db": 0.17403804697096348,
      "time_synthesis": 3.3841024511493742,
      "jaccard_index": 0.06535947712418301,
      "query_similarity": 0.9283667621776505,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "ordine": "2-202400007222"
        },
        {
          "ordine": "2-202400008274"
        },
        {
          "ordine": "2-202400007351"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-97-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore totale delle fatture fornitori (FFA) ricevute?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento {tipoOriginale: 'FFA'})-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nRETURN sum(dr.importo) AS totaleFattureFornitore",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FFA'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) RETURN sum(dr.importo) AS totaleFattureFornitore",
      "time_total": 32.36850563203916,
      "time_generation": 27.417597291059792,
      "time_db": 0.09898934699594975,
      "time_synthesis": 1.504000629298389,
      "jaccard_index": 1.0,
      "query_similarity": 0.7492063492063492,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-98-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i clienti a cui abbiamo inviato una nota di consegna clienti (DDTV) a Roma.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'DDTV'}) WHERE toLower(trim(doc.tipoOriginale)) CONTAINS 'roma' RETURN DISTINCT c.name AS cliente",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'DDTV'}) WHERE toLower(trim(doc.tipoOriginale)) CONTAINS 'roma' RETURN DISTINCT c.name AS cliente",
      "time_total": 25.27023723302409,
      "time_generation": 15.786633918993175,
      "time_db": 0.04174587596207857,
      "time_synthesis": 3.1864781421609223,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-99-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore fatturato presente solo nelle fatture clienti (FVC)?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'})\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleFatturatoInFVC",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' RETURN sum(dr.importo) AS totaleFatturatoInFVC",
      "time_total": 44.67934639612213,
      "time_generation": 35.45302967587486,
      "time_db": 0.2872755960561335,
      "time_synthesis": 2.1528360368683934,
      "jaccard_index": 1.0,
      "query_similarity": 0.9528535980148883,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-100-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il totale ordinato attraverso gli ordini clienti (OC) per la ditta '1'.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'})\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Ordinato'\nRETURN sum(dr.importo) AS totaleOrdinatoDitta1",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Ordinato' RETURN sum(dr.importo) AS totaleOrdinatoDitta1",
      "time_total": 48.12805144209415,
      "time_generation": 39.881838663015515,
      "time_db": 0.018369491212069988,
      "time_synthesis": 2.1026117647998035,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-101-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore medio delle righe fatturate nelle note di consegna clienti (DDTV)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento {tipoOriginale: 'DDTV'})-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN avg(dr.importo) AS valoreMedioBollato",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'DDTV'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Bollato' RETURN avg(dr.importo) AS valoreMedioBollato",
      "time_total": 42.93784617399797,
      "time_generation": 34.43973117694259,
      "time_db": 0.14791188202798367,
      "time_synthesis": 2.1249621459282935,
      "jaccard_index": 0.0,
      "query_similarity": 0.7002518891687658,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": 2,
      "strict_success": false,
      "attendibile": false,
      "mismatch_missing": [
        {
          "valoreMedioBollato": 287.9302638785166
        }
      ],
      "mismatch_extra": [
        {
          "valoreMedioBollato": null
        }
      ]
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-102-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il cliente con il valore fatturato pi\u00f9 alto considerando solo le fatture immediate (FVC)?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'})\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS totale\nORDER BY totale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS totale ORDER BY totale DESC LIMIT 1",
      "time_total": 45.25865396205336,
      "time_generation": 38.62216656515375,
      "time_db": 0.371408318169415,
      "time_synthesis": 2.2892299639061093,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-103-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per il cliente 'ACME SRL', confronta il totale ordinato e il totale fatturato.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente) WHERE toLower(trim(c.name)) = 'acme srl'\nOPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_ord:RigaDocumento {tipoValore: 'Ordinato'})\nWITH c, sum(dr_ord.importo) AS totaleOrdinato\nOPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento {tipoValore: 'Fatturato'}) WHERE dr_fat.importo > 0\nRETURN totaleOrdinato, sum(dr_fat.importo) AS totaleFatturato",
      "expected_cypher": "MATCH (c:Cliente) WHERE toLower(trim(c.name)) = 'acme srl' OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_ord:RigaDocumento {tipoValore: 'Ordinato'}) WITH c, sum(dr_ord.importo) AS totaleOrdinato OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento {tipoValore: 'Fatturato'}) WHERE dr_fat.importo > 0 RETURN totaleOrdinato, sum(dr_fat.importo) AS totaleFatturato",
      "time_total": 37.45377172995359,
      "time_generation": 34.34165410278365,
      "time_db": 0.03363276785239577,
      "time_synthesis": 1.6983312629163265,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-104-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i documenti d'ordine clienti (OC) che non sono ancora stati completamente fatturati.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'})\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento {tipoValore: 'Ordinato'})\nWITH doc, sum(dr.importo) AS valoreOrdinato\nMATCH (doc)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento {tipoValore: 'Fatturato'})\nWITH doc, valoreOrdinato, sum(dr_fat.importo) AS valoreFatturato\nWHERE valoreOrdinato > valoreFatturato\nRETURN doc.documentoId AS ordineNonSaldato\nORDER BY ordineNonSaldato\nLIMIT 10",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento {tipoValore: 'Ordinato'}) WITH doc, sum(dr.importo) AS valoreOrdinato MATCH (doc)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento {tipoValore: 'Fatturato'}) WITH doc, valoreOrdinato, sum(dr_fat.importo) AS valoreFatturato WHERE valoreOrdinato > valoreFatturato RETURN doc.documentoId AS ordineNonSaldato",
      "time_total": 37.93841473991051,
      "time_generation": 33.5568808959797,
      "time_db": 0.26925528375431895,
      "time_synthesis": 1.7133418899029493,
      "jaccard_index": 1.0,
      "query_similarity": 0.9585798816568047,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-105-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale tipo di documento (nome) ha il valore medio pi\u00f9 alto per riga (considerando solo i valori fatturati)?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType)\nMATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN dt.nome AS nomeTipoDocumento, avg(dr.importo) AS valoreMedioRiga\nORDER BY valoreMedioRiga DESC\nLIMIT 1",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN dt.nome AS nomeTipoDocumento, avg(dr.importo) AS valoreMedioRiga ORDER BY valoreMedioRiga DESC LIMIT 1",
      "time_total": 32.632197519764304,
      "time_generation": 28.293659545015544,
      "time_db": 0.45439655100926757,
      "time_synthesis": 1.989777505863458,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    },
    {
      "config": "specialist-llama3-coder",
      "test_id": "TEST-106-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il totale fatturato e il totale ordinato per ciascuna ditta.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nRETURN d.dittaId AS ditta, \n       sum(CASE dr.tipoValore WHEN 'Fatturato' THEN dr.importo ELSE 0 END) AS totaleFatturato, \n       sum(CASE dr.tipoValore WHEN 'Ordinato' THEN dr.importo ELSE 0 END) AS totaleOrdinato \nORDER BY ditta ASC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) RETURN d.dittaId AS ditta, sum(CASE dr.tipoValore WHEN 'Fatturato' THEN dr.importo ELSE 0 END) AS totaleFatturato, sum(CASE dr.tipoValore WHEN 'Ordinato' THEN dr.importo ELSE 0 END) AS totaleOrdinato ORDER BY ditta ASC",
      "time_total": 27.824093542061746,
      "time_generation": 21.16832434013486,
      "time_db": 0.45593982422724366,
      "time_synthesis": 4.673825554084033,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": 2,
      "strict_success": true,
      "attendibile": true,
      "success_reason": "jaccard"
    }
  ]
}