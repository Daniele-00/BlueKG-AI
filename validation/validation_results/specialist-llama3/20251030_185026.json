{
  "config": "specialist-llama3",
  "approach": "specialist",
  "config_name": "llama3",
  "timestamp": "20251030_185026",
  "examples_top_k": 0,
  "summary": {
    "total": 106,
    "success_strict": 20,
    "success_similarity": 14,
    "success_jaccard": 19,
    "failures": 86,
    "accuracy": 18.867924528301888,
    "accuracy_strict": 18.867924528301888,
    "accuracy_similarity": 13.20754716981132,
    "accuracy_jaccard": 17.92452830188679,
    "min_query_similarity": 0.8,
    "min_jaccard": 0.8,
    "avg_time": 48.734632892288126,
    "avg_jaccard": 0.26519219797461135,
    "avg_query_similarity": 0.5528974247282865
  },
  "results": [
    {
      "config": "specialist-llama3",
      "test_id": "TEST-01-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato totale del cliente BARONE DI FERRANTE EZIO?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente {name: \"BARONE DI FERRANTE EZIO\"})-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleRevenue",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoTotale",
      "time_total": 42.056891357991844,
      "time_generation": 24.895493905059993,
      "time_db": 0.24233706993982196,
      "time_synthesis": 9.70532668568194,
      "jaccard_index": 1.0,
      "query_similarity": 0.7601809954751131,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-02-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il cliente con il maggior fatturato?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 40.76642788620666,
      "time_generation": 23.480977409984916,
      "time_db": 0.8266821480356157,
      "time_synthesis": 14.544382419902831,
      "jaccard_index": 1.0,
      "query_similarity": 0.9737991266375546,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-03-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i 5 clienti che hanno fatturato di pi\u00f9 che si trovano a Perugia",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo)\nWHERE l.provincia = 'PG' // PG is the abbreviation for Perugia province\nMATCH (c)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c.name AS cliente, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nLIMIT 5\nRETURN cliente, fatturato",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.localita)) = 'perugia' MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 5",
      "time_total": 41.30015927599743,
      "time_generation": 24.074772506952286,
      "time_db": 0.5475522740744054,
      "time_synthesis": 14.144323778804392,
      "jaccard_index": 0.1111111111111111,
      "query_similarity": 0.8023774145616642,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "ITALICA RETAIL SRL",
          "fatturatoTotale": 428074.7800000002
        },
        {
          "cliente": "GMF SRL UNIPERSONALE",
          "fatturatoTotale": 5653946.039999996
        },
        {
          "cliente": "PAC 2000 A Societ\u00e0 Cooperativa",
          "fatturatoTotale": 1899139.800000001
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "GMF SRL UNIPERSONALE",
          "fatturato": 5827112.039999985
        },
        {
          "cliente": "L'ABBONDANZA SRL",
          "fatturato": 6077563.659999996
        },
        {
          "cliente": "GESPAC SRL",
          "fatturato": 1056805.94
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-04-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 5 prodotti pi\u00f9 popolari in termini di quantit\u00e0 venduta",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nRETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 5",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 5",
      "time_total": 47.08640839532018,
      "time_generation": 23.911843445152044,
      "time_db": 0.7285158988088369,
      "time_synthesis": 20.21209204616025,
      "jaccard_index": 1.0,
      "query_similarity": 0.9977628635346756,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-05-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 5 prodotti meno popolari in termini di quantit\u00e0 venduta",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE dr.tipoValore = 'Ordinato' AND dr.quantita > 0\nWITH a, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale ASC\nLIMIT 5\nRETURN a.descrizione AS prodotto, quantitaTotale AS quantitaVenduta",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale ASC LIMIT 5",
      "time_total": 50.41597117483616,
      "time_generation": 27.587527809664607,
      "time_db": 0.4613209059461951,
      "time_synthesis": 19.637809575069696,
      "jaccard_index": 0.0,
      "query_similarity": 0.7111111111111111,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "prodotto": "MS225 25A INTERRUTTORE SALVAMOTORE",
          "quantitaTotale": 0.0
        },
        {
          "prodotto": "COMPRESSORE SECOP SC18CLX",
          "quantitaTotale": 0.0
        },
        {
          "prodotto": "QUADRO ELETTRICO TN MASTER",
          "quantitaTotale": 0.0
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-06-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Dimmi il fatturato di ogni ditta.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)-[:APPARTIENE_A]->(c:Cliente)\nOPTIONAL MATCH (c)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(rd:RigaDocumento)\nWHERE rd.tipoValore = 'Fatturato'\nWITH d, SUM(rd.importo) AS totale\nRETURN d.dittaId AS company, totale AS revenue\nORDER BY revenue DESC\nLIMIT 20",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 43.109107521828264,
      "time_generation": 26.32894852431491,
      "time_db": 0.28403691574931145,
      "time_synthesis": 14.370671631768346,
      "jaccard_index": 0.0,
      "query_similarity": 0.6466165413533834,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "4",
          "fatturatoTotale": 1268387.26
        },
        {
          "ditta": "1",
          "fatturatoTotale": 3871373.63
        },
        {
          "ditta": "2",
          "fatturatoTotale": 37155291.67000106
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-07-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Il fatturato di ogni ditta, nel loro anno migliore",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN d.dittaId AS ditta, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC, d.dittaId ASC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY d.dittaId, fatturatoAnnuale DESC WITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati RETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 52.30764902103692,
      "time_generation": 28.406357828062028,
      "time_db": 0.7760748080909252,
      "time_synthesis": 20.804734792094678,
      "jaccard_index": 0.0,
      "query_similarity": 0.5563093622795116,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "4",
          "annoTop": 2023,
          "fatturatoMassimo": 320368.0
        },
        {
          "ditta": "3",
          "annoTop": 2024,
          "fatturatoMassimo": 804346.0799999994
        },
        {
          "ditta": "1",
          "annoTop": 2024,
          "fatturatoMassimo": 1242423.36
        }
      ],
      "mismatch_extra": [
        {
          "ditta": "4",
          "fatturato": 1268387.26
        },
        {
          "ditta": "1",
          "fatturato": 3871373.63
        },
        {
          "ditta": "2",
          "fatturato": 37155291.67000106
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-08-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Il fatturato di ogni ditta, nel loro anno peggiore",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN d.dittaId AS ditta, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC, d.dittaId ASC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY d.dittaId, fatturatoAnnuale ASC WITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati RETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 48.39486139314249,
      "time_generation": 28.705906237941235,
      "time_db": 0.7669676439836621,
      "time_synthesis": 16.830649389885366,
      "jaccard_index": 0.0,
      "query_similarity": 0.5570652173913043,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "4",
          "annoTop": 2025,
          "fatturatoMassimo": 26752.0
        },
        {
          "ditta": "1",
          "annoTop": 2021,
          "fatturatoMassimo": 478645.57
        },
        {
          "ditta": "2",
          "annoTop": 2025,
          "fatturatoMassimo": 1365461.8499999994
        }
      ],
      "mismatch_extra": [
        {
          "ditta": "4",
          "fatturato": 1268387.26
        },
        {
          "ditta": "1",
          "fatturato": 3871373.63
        },
        {
          "ditta": "2",
          "fatturato": 37155291.67000106
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-09-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la famiglia di prodotti pi\u00f9 acquistata?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(f:Famiglia)\nRETURN f.nome AS famiglia, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) RETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 1",
      "time_total": 41.10492932284251,
      "time_generation": 26.3998981253244,
      "time_db": 0.9435862367972732,
      "time_synthesis": 11.679643793962896,
      "jaccard_index": 1.0,
      "query_similarity": 0.9893238434163701,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-10-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la famiglia di prodotti meno acquistata?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(famiglia:Famiglia)\nWITH famiglia, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale ASC\nLIMIT 1\nRETURN famiglia.nome AS leastPurchasedFamily",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) RETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale ASC LIMIT 1",
      "time_total": 48.744896994903684,
      "time_generation": 26.651728792116046,
      "time_db": 0.7812567441724241,
      "time_synthesis": 18.253715165890753,
      "jaccard_index": 0.0,
      "query_similarity": 0.8752079866888519,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "famiglia": "COPERCHI NOTTE",
          "quantitaTotale": 316216.0
        }
      ],
      "mismatch_extra": [
        {
          "leastPurchasedFamily": "COPERCHI NOTTE"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-11-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il prodotto pi\u00f9 venduto in generale (per valore)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nMATCH (a:Articolo {descrizione: a.descrizione})-[:RIGUARDA_ARTICOLO]->(a)\nRETURN a.descrizione AS prodotto, totaleVenduto AS valoreVenduto\nORDER BY valoreVenduto DESC\nLIMIT 1",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto ORDER BY valoreVenduto DESC LIMIT 1",
      "time_total": 85.27416710881516,
      "time_generation": 30.725887335836887,
      "time_db": 25.25265613105148,
      "time_synthesis": 13.409283936023712,
      "jaccard_index": 0.0,
      "query_similarity": 0.5414012738853503,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "prodotto": "Articolo placeholder: ID_NON_DISPONIBILE",
          "valoreVenduto": 31833615.58000028
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-12-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il prodotto meno venduto in generale (per valore)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nMATCH (a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia)\nWHERE toLower(trim(a.descrizione)) = 'product_x'  // Replace with the actual product name\nWITH a, totaleVenduto\nORDER BY totaleVenduto ASC\nLIMIT 1\nRETURN a.descrizione AS prodotto, totaleVenduto AS totaleVenduto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto ORDER BY valoreVenduto ASC LIMIT 1",
      "time_total": 92.46149254776537,
      "time_generation": 30.404631739947945,
      "time_db": 25.656795831862837,
      "time_synthesis": 12.91209577769041,
      "jaccard_index": 0.0,
      "query_similarity": 0.5114401076716016,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "prodotto": "VITE",
          "valoreVenduto": 0.04
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-13-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "A quanto ho acquistato il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a'\nWITH f, sum(dr.importo) AS costoTotaleAcquisto\nRETURN f.ragioneSociale AS fornitore, costoTotaleAcquisto AS costo\nORDER BY costo DESC\nLIMIT 10",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' RETURN sum(dr.importo) AS costoTotaleAcquisto",
      "time_total": 46.98242692882195,
      "time_generation": 22.64067158708349,
      "time_db": 0.3152805878780782,
      "time_synthesis": 20.65324096987024,
      "jaccard_index": 0.0,
      "query_similarity": 0.45357142857142857,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "costoTotaleAcquisto": 578501.2
        }
      ],
      "mismatch_extra": [
        {
          "fornitore": "NIPPON GASES REFRIGERANTS SRL",
          "costo": 10706.5
        },
        {
          "fornitore": "NIPPON GASES INDUSTRIAL SRL",
          "costo": 0.0
        },
        {
          "fornitore": "ARCI SRL",
          "costo": 0.0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-14-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "A quanto l'ho venduto il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleVenduto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS totaleVenduto",
      "time_total": 37.45741520635784,
      "time_generation": 20.435136103071272,
      "time_db": 0.686284604948014,
      "time_synthesis": 13.523061345797032,
      "jaccard_index": 1.0,
      "query_similarity": 0.9928057553956835,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-15-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Situazione attuale della ditta '2'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta {dittaId: '2'})<-[:APPARTIENE_A]-(c:Cliente)\nRETURN c.name AS cliente, c.creditlimit AS creditLimit, c.accountnumber AS accountNumber\nORDER BY c.name\nLIMIT 10",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '2'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year IN [date().year, date().year - 1] RETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY anno DESC",
      "time_total": 50.140729332808405,
      "time_generation": 20.910187161061913,
      "time_db": 0.13199174590408802,
      "time_synthesis": 27.14363679662347,
      "jaccard_index": 0.0,
      "query_similarity": 0.3858267716535433,
      "specialist": "DITTE_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "anno": 2025,
          "fatturatoAnnuale": 1365461.8500000003
        },
        {
          "anno": 2024,
          "fatturatoAnnuale": 10316724.920000026
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "10GTEK TRANSCEIVERS CO.,LIMITED",
          "creditLimit": 0.0,
          "accountNumber": "2-C-2554"
        },
        {
          "cliente": "2M DI MAMMOLI MATTEO",
          "creditLimit": 0.0,
          "accountNumber": "2-C-2513"
        },
        {
          "cliente": "10GTEK TRANSCEIVERS CO.LIMITED",
          "creditLimit": 0.0,
          "accountNumber": "2-C-2551"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-16-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali ditte vendono prodotti della famiglia 'CENTRALI FRIGO'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(f:Famiglia)\nWHERE f.nome = 'CENTRALI FRIGO'\nWITH a\nMATCH (d:Ditta)<-[:APPARTIENE_A]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nRETURN DISTINCT d.dittaId AS ditta\nORDER BY ditta\nLIMIT 10",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' RETURN DISTINCT d.dittaId AS ditta ORDER BY ditta",
      "time_total": 44.343282440211624,
      "time_generation": 27.774310334119946,
      "time_db": 0.4529783930629492,
      "time_synthesis": 13.47611756902188,
      "jaccard_index": 0.6666666666666666,
      "query_similarity": 0.3695299837925446,
      "specialist": "DITTE_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "4"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-17-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanti clienti unici ha la ditta '1'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)\nRETURN count(DISTINCT c) AS numeroClientiUnici",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente) RETURN count(DISTINCT c) AS numeroClientiUnici",
      "time_total": 26.22740014595911,
      "time_generation": 13.34456146787852,
      "time_db": 0.02039226796478033,
      "time_synthesis": 10.927022968884557,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-18-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore ci ha inviato pi\u00f9 documenti?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nWITH f, count(DISTINCT doc) AS numDocs\nORDER BY numDocs DESC\nRETURN f.ragioneSociale AS supplier, numDocs AS totalDocuments\nLIMIT 1",
      "expected_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento) RETURN f.ragioneSociale AS fornitore, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC LIMIT 1",
      "time_total": 31.1816500662826,
      "time_generation": 19.051360090263188,
      "time_db": 0.12863836204633117,
      "time_synthesis": 9.869712299201638,
      "jaccard_index": 0.0,
      "query_similarity": 0.6190476190476191,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fornitore": "MORELLI SPA",
          "numeroDocumenti": 2841
        }
      ],
      "mismatch_extra": [
        {
          "supplier": "MORELLI SPA",
          "totalDocuments": 2832
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-19-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 clienti che non hanno mai acquistato il prodotto 'GAS FREON SOLSTICE N40 R448A'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo)\nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a'\nWITH a\nMATCH (c:Cliente)\nWHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nRETURN DISTINCT c.name AS cliente\nORDER BY cliente\nLIMIT 5",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' WITH a MATCH (c:Cliente) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) RETURN c.name AS cliente ORDER BY cliente LIMIT 5",
      "time_total": 38.97889334196225,
      "time_generation": 18.689905593637377,
      "time_db": 0.5033643627539277,
      "time_synthesis": 16.843936663120985,
      "jaccard_index": 1.0,
      "query_similarity": 0.9833024118738405,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-20-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la localit\u00e0 con il maggior numero di fornitori?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (l:Luogo)\nWITH l\nMATCH (f:Fornitore)-[:SI_TROVA_A]->(l)\nRETURN l.localita AS localita, count(f) AS numeroFornitori\nORDER BY numeroFornitori DESC\nLIMIT 1;",
      "expected_cypher": "MATCH (f:Fornitore)-[:SI_TROVA_A]->(l:Luogo) WHERE l.localita IS NOT NULL RETURN l.localita AS localita, count(DISTINCT f) AS numeroFornitori ORDER BY numeroFornitori DESC LIMIT 1",
      "time_total": 36.366908099967986,
      "time_generation": 20.329505676869303,
      "time_db": 0.1029888279736042,
      "time_synthesis": 13.961988355964422,
      "jaccard_index": 1.0,
      "query_similarity": 0.7988165680473372,
      "specialist": "DITTE_QUERY",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-21-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo medio per riga documento nelle fatture di vendita?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.ArithmeticError} {message: / by zero}",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND doc.tipoOriginale = 'Fatturato'\nWITH sum(dr.importo) AS totaleImporti, count(*) AS numeroDocumenti\nRETURN avg(totaleImporti / numeroDocumenti) AS mediaImportoPerLinea",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN avg(dr.importo) AS importoMedioRiga",
      "time_total": 43.366967727895826,
      "time_generation": 30.89819961413741,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-22-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami 10 documenti di tipo 'FVC' emessi a Gennaio 2025 al cliente 'L'ABBONDANZA SRL'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento {tipoOriginale: 'FVC', dataEmissione: date('2025-01-01')})-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE toLower(trim(f.ragioneSociale)) = 'l\\'abbondanza srl'\nRETURN doc.documentoId AS documento, dr.importo AS costo\nORDER BY costo DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) WHERE toLower(trim(c.name)) = 'l\\'abbondanza srl' AND dt.codice = 'FVC' AND doc.dataEmissione.year = 2025 AND doc.dataEmissione.month = 1 RETURN doc.documentoId AS documento LIMIT 10",
      "time_total": 35.541434314101934,
      "time_generation": 19.322955654002726,
      "time_db": 0.22545460797846317,
      "time_synthesis": 12.467813416849822,
      "jaccard_index": 0.0,
      "query_similarity": 0.27056672760511885,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "documento": "2-202500000859"
        },
        {
          "documento": "2-202500001227"
        },
        {
          "documento": "2-202500000881"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-23-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il margine di profitto del prodotto 'GAS FREON SOLSTICE N40 R448A'?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Variable `a` not defined",
      "generated_cypher": "MATCH (a:Articolo {descrizione: \"GAS FREON SOLSTICE N40 R448A\"})\nWHERE a.productId = 'your_product_id'\nWITH a\nMATCH (c:Cliente)-[:HA_RICEVUTO]->(d:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore='Fatturato' AND dr.importo>0 AND dr.RIGUARDA_ARTICOLO=a\nWITH c, sum(dr.importo) AS revenue\nMATCH (f:Fornitore)-[:HA_EMESSO]->(d)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore='Ordinato' AND dr.importo>0 AND dr.RIGUARDA_ARTICOLO=a\nWITH f, sum(dr.importo) AS cost\nRETURN revenue - cost AS profit_margin",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr1:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr1.tipoValore = 'Fatturato' AND dr1.importo > 0 WITH a, sum(dr1.importo) AS fatturato MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) WITH a, fatturato, sum(dr2.importo) AS costo RETURN a.descrizione AS prodotto, fatturato, costo, (fatturato - costo) AS margine",
      "time_total": 67.65165773266926,
      "time_generation": 30.581230296287686,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-24-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali fornitori ci forniscono prodotti venduti al cliente 'BARONE DI FERRANTE EZIO'?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'IN': expe",
      "generated_cypher": "MATCH (c:Cliente {name: 'BARONE DI FERRANTE EZIO'})-[:HA_RICEVUTO]->(d:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato'\nWITH c, collect(distinct f.ragioneSociale) AS suppliers\nMATCH (f:Fornitore {ragioneSociale IN suppliers})-[:HA_EMESSO]->(d)-[:CONTIENE_RIGA]->(dr)\nRETURN distinct f.ragioneSociale AS supplier\nORDER BY supplier\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' WITH collect(DISTINCT a) AS articoliVenduti MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) WHERE a IN articoliVenduti RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER BY fornitore",
      "time_total": 65.21506591886282,
      "time_generation": 27.73915057023987,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-25-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 prodotti che abbiamo venduto ma mai acquistato",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are n",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH a, count(*) AS soldCount\nMATCH (c2:Cliente) WHERE NOT (c2)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr)-[:RIGUARDA_ARTICOLO]->(a)\nRETURN DISTINCT a.descrizione AS prodotto, soldCount\nORDER BY soldCount DESC\nLIMIT 5",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE NOT EXISTS { MATCH (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) } RETURN DISTINCT a.descrizione AS prodotto ORDER BY prodotto LIMIT 5",
      "time_total": 89.98290989315137,
      "time_generation": 45.3979689469561,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-26-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 prodotti che abbiamo acquistato ma mai venduto",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'IN': expe",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE NOT (dr)-[:RIGUARDA_ARTICOLO]->(:Articolo) AND dr.tipoValore = 'Fatturato'\nWITH f, collect(dr.productId) AS productIds\nMATCH (p:Articolo {productId IN productIds})\nRETURN p.descrizione AS productName\nORDER BY productName\nLIMIT 5",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)\nWHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: 'Fatturato'})\nRETURN DISTINCT a.descrizione AS prodottoMaiVenduto\nORDER BY prodottoMaiVenduto\nLIMIT 5",
      "time_total": 75.76754814898595,
      "time_generation": 26.618566473945975,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-27-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato della sottofamiglia 'COMPRESSORI SEMIERMETICI'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)\nWHERE sf.nome = 'COMPRESSORI SEMIERMETICI'\nMATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nRETURN c.name AS cliente, totaleVenduto AS revenue\nORDER BY revenue DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia) WHERE toLower(trim(sf.nome)) = 'compressori semiermetici' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoSottofamiglia",
      "time_total": 46.743623515125364,
      "time_generation": 27.242331373039633,
      "time_db": 0.9006421286612749,
      "time_synthesis": 15.339474701322615,
      "jaccard_index": 0.0,
      "query_similarity": 0.4311377245508982,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fatturatoSottofamiglia": 0
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-28-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca le sottofamiglie della famiglia 'CENTRALI FRIGO'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Famiglia)<-[:INCLUSA_IN]-(:Sottofamiglia)<-[:APPARTIENE_A]-(sf:Sottofamiglia)\nWHERE toLower(trim(f.nome)) = 'centrali frigo'\nRETURN DISTINCT sf.nome AS subfamily ORDER BY subfamily",
      "expected_cypher": "MATCH (f:Famiglia)<-[:INCLUSA_IN]-(sf:Sottofamiglia) WHERE toLower(trim(f.nome)) = 'centrali frigo' RETURN DISTINCT sf.nome AS sottofamiglia ORDER BY sottofamiglia",
      "time_total": 28.081681788899004,
      "time_generation": 16.599687372799963,
      "time_db": 0.149056825786829,
      "time_synthesis": 9.138772340957075,
      "jaccard_index": 0.0,
      "query_similarity": 0.8465909090909091,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "sottofamiglia": "N/D"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-29-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato del primo trimestre 2024?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.dataEmissione.year = 2024 AND doc.dataEmissione.quarter = 'Q1'\nAND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024 AND doc.dataEmissione.month >= 1 AND doc.dataEmissione.month <= 3 RETURN sum(dr.importo) AS fatturatoTrimestre",
      "time_total": 37.58072732761502,
      "time_generation": 26.485523140989244,
      "time_db": 0.30748384492471814,
      "time_synthesis": 8.518707911018282,
      "jaccard_index": 0.0,
      "query_similarity": 0.5120274914089347,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fatturatoTrimestre": 2865507.280000003
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-30-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato tra Gennaio 2024 e Marzo 2024?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.dataEmissione >= datetime(\"2024-01-01\") AND doc.dataEmissione <= datetime(\"2024-03-31\")\nAND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleVenduto",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione >= date('2024-01-01') AND doc.dataEmissione <= date('2024-03-31') RETURN sum(dr.importo) AS fatturatoPeriodo",
      "time_total": 42.040100342128426,
      "time_generation": 28.093609239906073,
      "time_db": 0.2273336066864431,
      "time_synthesis": 11.17074421979487,
      "jaccard_index": 0.0,
      "query_similarity": 0.6091743119266055,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fatturatoPeriodo": 2865507.279999998
        }
      ],
      "mismatch_extra": [
        {
          "totaleVenduto": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-31-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i clienti con fatturato superiore a 50000 euro",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 50000\nRETURN c.name AS cliente, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS fatturatoTotale WHERE fatturatoTotale > 50000 RETURN c.name AS cliente, fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 34.95652712788433,
      "time_generation": 19.37410452729091,
      "time_db": 0.23189260624349117,
      "time_synthesis": 13.131334795150906,
      "jaccard_index": 0.0,
      "query_similarity": 0.7426326129666012,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "NUOVA C.R.SUPERMERCATI SRL",
          "fatturatoTotale": 704091.4899999999
        },
        {
          "cliente": "SUPERMERCATO S.LUCIA S.R.L. UNIPERSONALE",
          "fatturatoTotale": 108851.15
        },
        {
          "cliente": "EOLIE DISCOUNT SRL",
          "fatturatoTotale": 142285.75000000003
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "PAC 2000 A Societ\u00e0 Cooperativa",
          "fatturato": 591500.0
        },
        {
          "cliente": "NUOVA C.R.SUPERMERCATI SRL",
          "fatturato": 304500.0
        },
        {
          "cliente": "L'ABBONDANZA SRL",
          "fatturato": 2537629.0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-32-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 3 prodotti pi\u00f9 venduti al cliente 'BARONE DI FERRANTE EZIO'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente {name: 'BARONE DI FERRANTE EZIO'})-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nMATCH (a:Articolo)-[:RIGUARDA_ARTICOLO]->(dr)\nRETURN a.descrizione AS prodotto, totaleVenduto AS vendite\nORDER BY totaleVenduto DESC\nLIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS totaleVenduto ORDER BY totaleVenduto DESC LIMIT 3",
      "time_total": 47.3908503879793,
      "time_generation": 30.92164591513574,
      "time_db": 0.27057765889912844,
      "time_synthesis": 13.273342033848166,
      "jaccard_index": 0.0,
      "query_similarity": 0.4470588235294118,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "prodotto": "Articolo placeholder: ID_NON_DISPONIBILE",
          "totaleVenduto": 1557.38
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-33-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 3 prodotti meno venduti al cliente 'BARONE DI FERRANTE EZIO'?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expec",
      "generated_cypher": "MATCH (c:Cliente {name: \"BARONE DI FERRANTE EZIO\"})-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nMATCH (a:Articolo)-[:RIGUARDA_ARTICOLO]->(dr)\nWHERE a IN (\n  MATCH (c)-[:HA_RICEVUTO]->(doc)-[:CONTIENE_RIGA]->(dr)\n  WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\n  WITH c, sum(dr.importo) AS totaleVenduto\n  ORDER BY totaleVenduto ASC\n  LIMIT 3\n)\nRETURN a.descrizione AS prodotto, totaleVenduto AS totaleVenduto\nORDER BY totaleVenduto DESC\nLIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS totaleVenduto ORDER BY totaleVenduto ASC LIMIT 3",
      "time_total": 71.48570183012635,
      "time_generation": 29.211188554298133,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-34-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanti fornitori appartengono a ciascun gruppo di fornitori?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore)\nWITH f, gf\nMATCH (c:Cliente {customertypecode: 'Supplier'})-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato'\nWITH c, f, gf, COUNT(DISTINCT f.fornitoreId) AS supplierCount\nRETURN supplierCount ORDER BY supplierCount DESC;",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore) RETURN gf.ragioneSociale AS gruppo, count(f) AS numeroFornitori ORDER BY numeroFornitori DESC",
      "time_total": 58.50090251211077,
      "time_generation": 21.974375418853015,
      "time_db": 22.56135588604957,
      "time_synthesis": 11.85954758618027,
      "jaccard_index": 0.0,
      "query_similarity": 0.27346938775510204,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "gruppo": "OPTIMUM WAY SAS",
          "numeroFornitori": 1
        },
        {
          "gruppo": "AUTO-CAR-ELETTRA",
          "numeroFornitori": 2
        },
        {
          "gruppo": "GASFRIGO SRLS",
          "numeroFornitori": 1
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-35-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo minimo registrato in una singola riga di fattura di vendita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN MIN(dr.importo) AS minImporto",
      "expected_cypher": "MATCH (dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN min(dr.importo) AS importoMinimo",
      "time_total": 37.01976296491921,
      "time_generation": 20.6952210678719,
      "time_db": 0.5720041678287089,
      "time_synthesis": 13.275643296074122,
      "jaccard_index": 1.0,
      "query_similarity": 0.7372013651877133,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-36-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo massimo registrato in una singola riga di fattura di vendita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN MAX(dr.importo) AS maxImporto",
      "expected_cypher": "MATCH (dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN max(dr.importo) AS importoMassimo",
      "time_total": 29.828812518622726,
      "time_generation": 16.037347000092268,
      "time_db": 0.522952517028898,
      "time_synthesis": 11.097037992905825,
      "jaccard_index": 1.0,
      "query_similarity": 0.7278911564625851,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-37-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la quantit\u00e0 media di articoli per riga nei documenti di acquisto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH f, sum(dr.quantita) AS totaleQuantita\nRETURN avg(totaleQuantita) AS mediaQuantitaPerRow",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) RETURN avg(dr.quantita) AS quantitaMediaAcquisto",
      "time_total": 55.54060053592548,
      "time_generation": 26.33919399511069,
      "time_db": 8.722345100715756,
      "time_synthesis": 17.728966313879937,
      "jaccard_index": 0.0,
      "query_similarity": 0.5179063360881543,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "quantitaMediaAcquisto": 15.556584842962813
        }
      ],
      "mismatch_extra": [
        {
          "mediaQuantitaPerRow": null
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-38-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanti articoli unici sono presenti nel catalogo?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (a:Articolo)\nRETURN DISTINCT a.descrizione AS prodotto\nORDER BY prodotto\nLIMIT 20",
      "expected_cypher": "MATCH (a:Articolo) RETURN count(DISTINCT a) AS totaleArticoli",
      "time_total": 25.88356575416401,
      "time_generation": 10.332670485135168,
      "time_db": 0.11751225404441357,
      "time_synthesis": 13.630286832340062,
      "jaccard_index": 0.0,
      "query_similarity": 0.6081081081081081,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "totaleArticoli": 18756
        }
      ],
      "mismatch_extra": [
        {
          "prodotto": "04882 MORSETTIERA 8 MOD 2X125A"
        },
        {
          "prodotto": "."
        },
        {
          "prodotto": "02583 CANALE CABLAGGIO T1-EN"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-39-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i clienti dell'azienda '1' situati nella provincia di 'PG'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta {dittaId: \"1\"})\n-[:APPARTIENE_A]->(c:Cliente)\n-[:HAS_ADDRESS]->(l:Luogo)\nWHERE toLower(trim(l.provincia)) = \"pg\"\nRETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 20",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.provincia)) = 'pg' RETURN c.name AS cliente ORDER BY cliente",
      "time_total": 23.13664166489616,
      "time_generation": 9.354036645032465,
      "time_db": 0.17575012473389506,
      "time_synthesis": 11.321954254992306,
      "jaccard_index": 0.0,
      "query_similarity": 0.9152542372881356,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "TRADIZIONE PERUGINA di Paciola"
        },
        {
          "cliente": "MANDARINO SNC"
        },
        {
          "cliente": "EDO di Merli Salvatore"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-40-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Calcola il fatturato totale per il secondo trimestre del 2024 (aprile, maggio, giugno).",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.dataEmissione >= datetime(\"2024-04-01\") AND doc.dataEmissione <= datetime(\"2024-06-30\")\nAND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleVenduto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024 AND doc.dataEmissione.month IN [4, 5, 6] RETURN sum(dr.importo) AS fatturatoTrimestre",
      "time_total": 50.4868310848251,
      "time_generation": 27.262149622663856,
      "time_db": 0.04709784593433142,
      "time_synthesis": 20.621586572844535,
      "jaccard_index": 0.0,
      "query_similarity": 0.6191369606003753,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fatturatoTrimestre": 3466773.780000001
        }
      ],
      "mismatch_extra": [
        {
          "totaleVenduto": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-41-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Trova tutti gli articoli la cui descrizione inizia con 'TUBO'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (a:Articolo)\nWHERE toLower(trim(a.descrizione)) = 'tubo'\nRETURN DISTINCT a.descrizione AS articolo\nORDER BY articolo\nLIMIT 20",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) STARTS WITH 'tubo' RETURN a.descrizione AS articolo",
      "time_total": 25.920857987832278,
      "time_generation": 12.781993645709008,
      "time_db": 0.1355163431726396,
      "time_synthesis": 10.836119744926691,
      "jaccard_index": 0.0,
      "query_similarity": 0.7966101694915254,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "articolo": "TUBO NEON TL HE 21W/840"
        },
        {
          "articolo": "TUBO ALTA PRESSIONE OLIO"
        },
        {
          "articolo": "TUBO ARMAFLEX 19X18"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-42-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i documenti di tipo 'FNA' ricevuti dal fornitore 'FORNITORE ESEMPIO SPA'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore {ragioneSociale: \"CENTRALI FRIGO\"})-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.tipoOriginale = 'FNA'\nRETURN doc\nORDER BY doc.dataEmissione DESC\nLIMIT 10",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) WHERE toLower(trim(gf.ragioneSociale)) = 'fornitore esempio spa' AND dt.codice = 'FNA' RETURN doc.documentoId AS documento",
      "time_total": 31.909158332273364,
      "time_generation": 16.174027753062546,
      "time_db": 0.19738493906334043,
      "time_synthesis": 12.83816140005365,
      "jaccard_index": 1.0,
      "query_similarity": 0.3738738738738739,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-43-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi sono i 3 clienti con il fatturato pi\u00f9 basso?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleRevenue\nORDER BY totaleRevenue ASC LIMIT 3\nRETURN c.name AS cliente, totaleRevenue AS revenue",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale ASC LIMIT 3",
      "time_total": 47.01094539789483,
      "time_generation": 26.79043746460229,
      "time_db": 0.5272763180546463,
      "time_synthesis": 17.09130249498412,
      "jaccard_index": 0.5,
      "query_similarity": 0.7323943661971831,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "LA DISPENSA SRL",
          "fatturatoTotale": 90.0
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "MORELLI SPA",
          "revenue": 70.0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-44-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi sono i 3 clienti con il fatturato pi\u00f9 alto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nRETURN c.name AS cliente, totaleVenduto\nORDER BY totaleVenduto DESC\nLIMIT 3",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 3",
      "time_total": 46.42631481401622,
      "time_generation": 30.608286587055773,
      "time_db": 0.5756757273338735,
      "time_synthesis": 12.804253735113889,
      "jaccard_index": 0.2,
      "query_similarity": 0.7622950819672131,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "GMF SRL UNIPERSONALE",
          "fatturatoTotale": 5827112.03999998
        },
        {
          "cliente": "L'ABBONDANZA SRL",
          "fatturatoTotale": 6077563.659999978
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "GMF SRL UNIPERSONALE",
          "totaleVenduto": 5649146.039999996
        },
        {
          "cliente": "L'ABBONDANZA SRL",
          "totaleVenduto": 5785617.85999999
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-45-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 5 articoli con il costo totale di acquisto pi\u00f9 alto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH a, sum(dr.importo) AS totaleAcquistato\nORDER BY totaleAcquistato DESC\nRETURN a.descrizione AS articolo, totaleAcquistato AS costoTotale\nLIMIT 5",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) RETURN a.descrizione AS articolo, sum(dr.importo) AS costoTotale ORDER BY costoTotale DESC LIMIT 5",
      "time_total": 46.967377374880016,
      "time_generation": 24.74643554771319,
      "time_db": 0.37728859577327967,
      "time_synthesis": 19.39225389715284,
      "jaccard_index": 0.6666666666666666,
      "query_similarity": 0.3105590062111801,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "articolo": "CENTRALINA MCX08M2 DANFOSS",
          "costoTotale": 37814.88
        }
      ],
      "mismatch_extra": [
        {
          "articolo": "CENTRALINA MCX08M2 DANFOSS",
          "costoTotale": 24660.48
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-46-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono i 5 articoli con il costo totale di acquisto pi\u00f9 basso?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\n-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH a, sum(dr.importo) AS totaleAcquistato\nORDER BY totaleAcquistato ASC\nLIMIT 5\nRETURN a.descrizione AS articolo, totaleAcquistato AS costoTotale",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) RETURN a.descrizione AS articolo, sum(dr.importo) AS costoTotale ORDER BY costoTotale ASC LIMIT 5",
      "time_total": 39.35185934510082,
      "time_generation": 27.124805798288435,
      "time_db": 0.37508018082007766,
      "time_synthesis": 9.142469271086156,
      "jaccard_index": 1.0,
      "query_similarity": 0.2821576763485477,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-47-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore ci vende la gamma pi\u00f9 ampia di articoli unici?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH f, collect(distinct a.descrizione) AS uniqueArticles\nORDER BY size(uniqueArticles) DESC\nRETURN f.ragioneSociale AS supplier, size(uniqueArticles) AS numUniqueArticles\nLIMIT 1",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS varietaProdotti ORDER BY varietaProdotti DESC LIMIT 1",
      "time_total": 41.01925062201917,
      "time_generation": 24.498811007011682,
      "time_db": 0.441036410164088,
      "time_synthesis": 13.263140756171197,
      "jaccard_index": 0.0,
      "query_similarity": 0.06315789473684211,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fornitore": "MORELLI SPA",
          "varietaProdotti": 383
        }
      ],
      "mismatch_extra": [
        {
          "supplier": "MORELLI SPA",
          "numUniqueArticles": 372
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-48-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore ci vende la gamma meno ampia di articoli unici?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWITH f, COUNT(DISTINCT a.productId) AS numProducts\nORDER BY numProducts ASC\nLIMIT 1\nRETURN f.ragioneSociale AS supplierName",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS varietaProdotti ORDER BY varietaProdotti ASC LIMIT 1",
      "time_total": 48.443027211818844,
      "time_generation": 23.027487764600664,
      "time_db": 9.142589285969734,
      "time_synthesis": 13.75843117525801,
      "jaccard_index": 0.0,
      "query_similarity": 0.050387596899224806,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fornitore": "10GTEK TRANSCEIVERS CO.LIMITED",
          "varietaProdotti": 1
        }
      ],
      "mismatch_extra": [
        {
          "supplierName": "AMAZON EU S.A.R.L. 3 SUCURSAL EN ESPANA"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-49-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ordina le aziende in base al numero totale di documenti di vendita emessi.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Variable `d` not defined",
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)\nWITH c.name AS cliente, count(doc) AS numeroDocumenti\nRETURN d.dittaId AS ditta, numeroDocumenti\nORDER BY numeroDocumenti DESC;",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento) RETURN d.dittaId AS ditta, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC",
      "time_total": 43.36270344816148,
      "time_generation": 18.2199420388788,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-50-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fornitore con il maggior numero di articoli forniti?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWITH f, COUNT(DISTINCT dr) AS num_items\nRETURN f.ragioneSociale AS supplier, num_items AS total_items\nORDER BY num_items DESC\nLIMIT 1;",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS numeroArticoli ORDER BY numeroArticoli DESC LIMIT 1",
      "time_total": 36.718320411629975,
      "time_generation": 19.907057794276625,
      "time_db": 0.22123343823477626,
      "time_synthesis": 14.47101997025311,
      "jaccard_index": 0.0,
      "query_similarity": 0.1680327868852459,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fornitore": "MORELLI SPA",
          "numeroArticoli": 383
        }
      ],
      "mismatch_extra": [
        {
          "supplier": "MORELLI SPA",
          "total_items": 18773
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-51-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi sono i principali fornitori degli articoli venduti al nostro miglior cliente?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expec",
      "generated_cypher": "MATCH (c:Cliente {name: 'best_customer'})-[:HA_RICEVUTO]->(d:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' // or 'Ordinato' if you want to consider orders\nWITH c, sum(dr.importo) AS totaleAcquistato\nMATCH (f:Fornitore)-[:HA_EMESSO]->(d)<-[:CONTIENE_RIGA]-(dr)\nWHERE f.ragioneSociale IN (\n  MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore {ragioneSociale: f.ragioneSociale})\n  RETURN gf.ragioneSociale\n)\nRETURN DISTINCT f.ragioneSociale AS supplier, totaleAcquistato AS total_value\nORDER BY total_value DESC\nLIMIT 10;",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 1 WITH c AS topCliente MATCH (topCliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WITH topCliente, collect(DISTINCT a) AS articoliDelTopCliente MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE a IN articoliDelTopCliente RETURN gf.ragioneSociale AS fornitore, count(DISTINCT a) AS numeroArticoliDiversiForniti ORDER BY numeroArticoliDiversiForniti DESC",
      "time_total": 91.76019208598882,
      "time_generation": 32.55333409784362,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-52-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali sono le famiglie di prodotti vendute sia dalla ditta '1' che dalla ditta '2'?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '{': expec",
      "generated_cypher": "MATCH (d1:Ditta {dittaId: \"1\"})-[:APPARTIENE_A]->(c1:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nMATCH (d2:Ditta {dittaId: \"2\"})-[:APPARTIENE_A]->(c2:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nWHERE a.Famiglia.nome IN (\n  MATCH (f:Fornitore {ragioneSociale: \"Supplier X\"})-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore)-[:INCLUSA_IN]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fa:Famiglia)\n  RETURN fa.nome\n) AND a.Famiglia.nome IN (\n  MATCH (f:Fornitore {ragioneSociale: \"Supplier Y\"})-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore)-[:INCLUSA_IN]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fa:Famiglia)\n  RETURN fa.nome\n)\nRETURN DISTINCT a.Famiglia.nome AS famiglia ORDER BY famiglia;",
      "expected_cypher": "MATCH (fam1:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta {dittaId: '1'}) WITH collect(DISTINCT fam1) AS famiglieDitta1 MATCH (fam2:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta {dittaId: '2'}) WHERE fam2 IN famiglieDitta1 RETURN DISTINCT fam2.nome AS famigliaComune ORDER BY famigliaComune",
      "time_total": 122.93600205564871,
      "time_generation": 38.3489851099439,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-53-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami 5 prodotti che abbiamo acquistato ma mai venduto.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Variable `a` not defined",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE NOT (dr)-[:RIGUARDA_ARTICOLO]->(:Articolo) // exclude products that were sold\nWITH f, collect(dr.productId) AS productIds\nMATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(p) WHERE p IN productIds\nRETURN a.descrizione AS productName LIMIT 5\nORDER BY a.descrizione ASC;",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WITH DISTINCT a WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: 'Fatturato'}) RETURN a.descrizione AS prodottoMaiVenduto LIMIT 5",
      "time_total": 66.10719335777685,
      "time_generation": 25.998186020646244,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-54-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il fatturato totale per ogni mese dell'anno corrente della ditta '1'.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': e",
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH doc.dataEmissione.year AS year, MONTH(doc.dataEmissione) AS month, sum(dr.importo) AS revenue\nGROUP BY year, month\nORDER BY year, month\nRETURN {year: year, month: month, revenue: revenue}",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE date(doc.dataEmissione).year = date().year AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN date(doc.dataEmissione).month AS mese, sum(dr.importo) AS fatturatoMensile ORDER BY mese ASC",
      "time_total": 64.70510067790747,
      "time_generation": 28.680040433071554,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-55-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Confronta il fatturato totale del 2024 con quello del 2023.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(CASE WHEN doc.dataEmissione.year = 2024 THEN dr.importo ELSE 0 END) AS fatturato2024,\n     sum(CASE WHEN doc.dataEmissione.year = 2023 THEN dr.importo ELSE 0 END) AS fatturato2023\nRETURN fatturato2024, fatturato2023\nORDER BY fatturato2024 DESC, fatturato2023 DESC;",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year IN [2023, 2024] RETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoTotale ORDER BY anno",
      "time_total": 44.38479468272999,
      "time_generation": 23.799229259602726,
      "time_db": 1.092628506012261,
      "time_synthesis": 16.318415727932006,
      "jaccard_index": 0.0,
      "query_similarity": 0.5264705882352941,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "anno": 2023,
          "fatturatoTotale": 12882538.920000063
        },
        {
          "anno": 2024,
          "fatturatoTotale": 12683756.870000148
        }
      ],
      "mismatch_extra": [
        {
          "fatturato2024": 431902.85000000097,
          "fatturato2023": 114773.46000000008
        },
        {
          "fatturato2024": 650.0,
          "fatturato2023": 3650.0
        },
        {
          "fatturato2024": 11968.75,
          "fatturato2023": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-56-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale fornitore \u00e8 stato il pi\u00f9 attivo (per valore di acquisto) nell'ultimo trimestre?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' // Filter for purchase value\nWITH f, sum(dr.importo) AS totaleAcquistato\nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore)\nWHERE gf.dataCaricamento >= date('2022-10-01') AND gf.dataCaricamento <= date('2022-12-31')\nRETURN f.ragioneSociale AS supplier, totaleAcquistato AS purchaseValue\nORDER BY purchaseValue DESC\nLIMIT 1",
      "expected_cypher": "WITH date() - duration({months: 3}) AS dataInizioTrimestre MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE doc.dataEmissione >= dataInizioTrimestre RETURN gf.ragioneSociale AS fornitore, sum(dr.importo) AS totaleAcquistato ORDER BY totaleAcquistato DESC LIMIT 1",
      "time_total": 50.818352688103914,
      "time_generation": 34.82758682779968,
      "time_db": 0.37916500912979245,
      "time_synthesis": 12.858112475834787,
      "jaccard_index": 1.0,
      "query_similarity": 0.325,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-57-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i clienti il cui primo documento di vendita \u00e8 stato emesso negli ultimi 6 mesi.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input '(': expec",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)\nWHERE doc.dataEmissione >= datetime().minusMonths(6).date()\nWITH c, min(doc.dataEmissione) AS firstSaleDate\nRETURN DISTINCT c.name AS cliente\nORDER BY cliente\nLIMIT 10;",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento) WITH c, min(doc.dataEmissione) AS primoAcquisto WHERE primoAcquisto >= date() - duration({months: 6}) RETURN c.name AS clienteRecente, primoAcquisto ORDER BY primoAcquisto DESC",
      "time_total": 37.17265406763181,
      "time_generation": 20.52566844271496,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-58-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ci sono aziende che non hanno registrato alcun fatturato?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo <= 0\nRETURN c.name AS cliente\nORDER BY cliente\nLIMIT 10",
      "expected_cypher": "MATCH (d:Ditta) WHERE NOT (d)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Fatturato'}) RETURN d.dittaId AS dittaSenzaFatturato",
      "time_total": 31.574188972823322,
      "time_generation": 18.725638416130096,
      "time_db": 0.4375237920321524,
      "time_synthesis": 10.094463952351362,
      "jaccard_index": 1.0,
      "query_similarity": 0.6402116402116402,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-59-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ultimo documento emesso nel 2024",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nWHERE doc.dataEmissione >= '2024-01-01' AND doc.dataEmissione <= '2024-12-31'\nRETURN doc ORDER BY doc.dataEmissione DESC LIMIT 1",
      "expected_cypher": "MATCH (doc:Documento) WHERE doc.dataEmissione.year = 2024 WITH doc ORDER BY doc.dataEmissione DESC LIMIT 1 OPTIONAL MATCH (doc)<-[:HA_RICEVUTO]-(c:Cliente) OPTIONAL MATCH (doc)<-[:HA_EMESSO]-(f:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore) RETURN doc.documentoId AS UltimodocumentoId,  doc.dataEmissione AS DataEmissione, CASE WHEN gf IS NOT NULL THEN gf.ragioneSociale ELSE 'Nostra Azienda (Vendita)' END AS EmessoDa, CASE WHEN c IS NOT NULL THEN c.name ELSE 'Nostra Azienda (Acquisto)' END AS EmessoA",
      "time_total": 29.74148936709389,
      "time_generation": 17.08300259290263,
      "time_db": 0.13166244979947805,
      "time_synthesis": 10.356684559956193,
      "jaccard_index": 0.0,
      "query_similarity": 0.2852983988355167,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "UltimodocumentoId": "2-202400020704",
          "DataEmissione": "2024-12-31",
          "EmessoDa": "Nostra Azienda (Vendita)",
          "EmessoA": "ROMI S.R.L."
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-60-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Trova i fornitori che non ci hanno mai venduto prodotti della famiglia 'CENTRALI FRIGO'",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE NOT (f)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)<-[:INCLUSA_IN]->(:Famiglia {nome: \"CENTRALI FRIGO\"})\nRETURN f.ragioneSociale AS fornitore\nORDER BY f.ragioneSociale\nLIMIT 10",
      "expected_cypher": "MATCH (fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' WITH fam MATCH (gf:GruppoFornitore) WHERE NOT (gf)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam) RETURN gf.ragioneSociale AS fornitore",
      "time_total": 42.310869586188346,
      "time_generation": 21.34230755874887,
      "time_db": 0.6191482190042734,
      "time_synthesis": 17.921706513967365,
      "jaccard_index": 0.0013157894736842105,
      "query_similarity": 0.513595166163142,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fornitore": "VODAFONE ITALIA SPA"
        },
        {
          "fornitore": "LE BONTA'PANETTERIA PASTICCERIA"
        },
        {
          "fornitore": "CONTAINER BOX SAS"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-61-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali clienti appartengono esclusivamente all'azienda '1' e non ad altre?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)\nWHERE NOT exists((c)-[:APPARTIENE_A]->(:Ditta))\nRETURN c.name AS cliente\nORDER BY cliente\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:APPARTIENE_A]->(d:Ditta) WITH c, collect(d.dittaId) AS ditte WHERE size(ditte) = 1 AND ditte[0] = '1' RETURN c.name AS clienteEsclusivo",
      "time_total": 44.88817116199061,
      "time_generation": 21.519899180158973,
      "time_db": 6.446414527017623,
      "time_synthesis": 14.463011169340461,
      "jaccard_index": 0.0,
      "query_similarity": 0.46645367412140576,
      "specialist": "DITTE_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "clienteEsclusivo": "TRADIZIONE PERUGINA di Paciola"
        },
        {
          "clienteEsclusivo": "MANDARINO SNC"
        },
        {
          "clienteEsclusivo": "EDO di Merli Salvatore"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-62-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per ogni famiglia di prodotto, chi \u00e8 il cliente che ha generato il fatturato maggiore?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nMATCH (a:Articolo {descrizione: a.descrizione})-[:APPARTIENE_A]->(f:Famiglia)\nWHERE f.nome IN ['family1', 'family2']\nRETURN c.name AS cliente, totaleVenduto, f.nome AS famiglia\nORDER BY totaleVenduto DESC",
      "expected_cypher": "MATCH (fam:Famiglia)<-[:INCLUSA_IN]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(c:Cliente) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH fam, c, sum(dr.importo) AS fatturato ORDER BY fam.nome, fatturato DESC WITH fam, collect({cliente: c.name, fatturato: fatturato}) AS clientiOrdinati RETURN fam.nome AS famiglia, clientiOrdinati[0].cliente AS topCliente, clientiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 67.22925532562658,
      "time_generation": 26.540103224571794,
      "time_db": 25.913172830827534,
      "time_synthesis": 11.817417418584228,
      "jaccard_index": 0.0,
      "query_similarity": 0.10750279955207166,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "famiglia": "CONDENSATORI",
          "topCliente": "GMF SRL UNIPERSONALE",
          "fatturatoMassimo": 2501148.450000005
        },
        {
          "famiglia": "UGELLI",
          "topCliente": "GMF SRL UNIPERSONALE",
          "fatturatoMassimo": 2501148.450000005
        },
        {
          "famiglia": "SEPARATORI",
          "topCliente": "GMF SRL UNIPERSONALE",
          "fatturatoMassimo": 2501148.450000005
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-63-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Calcola il rapporto tra costo totale e fatturato totale per il prodotto 'GAS FREON SOLSTICE N40 R448A'",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected ",
      "generated_cypher": "MATCH (a:Articolo {descrizione: \"GAS FREON SOLSTICE N40 R448A\"})\n-[:RIGUARDA_ARTICOLO]->(rd:RigaDocumento)\nWHERE rd.tipoValore = 'Fatturato'\nWITH sum(rd.importo) AS totale\nMATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(rd)\nWHERE doc.dataEmissione.year = 2025 AND doc.dataEmissione.month = 1\nRETURN totale / size((c)) AS ratio",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WITH a, sum(dr_acq.importo) AS costoTotale OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento {tipoValore: 'Fatturato'})<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente) WHERE dr_ven.importo > 0 WITH costoTotale, sum(dr_ven.importo) AS fatturatoTotale RETURN  costoTotale, fatturatoTotale, CASE WHEN costoTotale <> 0 THEN fatturatoTotale / costoTotale ELSE null END AS rapporto",
      "time_total": 64.71284248679876,
      "time_generation": 25.091486332006752,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-64-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale provincia ha generato il volume di fatturato pi\u00f9 alto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (l:Luogo)\nWITH l\nMATCH (c:Cliente)-[:HAS_ADDRESS]->(l)\nMATCH (c)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE a.descrizione IS NOT NULL\nWITH l, SUM(dr.importo) AS totale\nORDER BY totale DESC\nRETURN l.provincia AS provincia\nLIMIT 1;",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN l.provincia AS provincia, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 47.93676644610241,
      "time_generation": 19.857347967103124,
      "time_db": 11.289645930286497,
      "time_synthesis": 13.864106697961688,
      "jaccard_index": 0.0,
      "query_similarity": 0.5896551724137931,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "provincia": "PG",
          "fatturatoTotale": 25544465.930000313
        }
      ],
      "mismatch_extra": [
        {
          "provincia": "PG"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-65-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale provincia ha generato il volume di fatturato pi\u00f9 basso?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo)\nMATCH (c)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH l.provincia AS provincia, sum(dr.importo) AS totaleVenduto\nORDER BY totaleVenduto ASC\nRETURN MIN(provincia) AS minProvincia",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN l.provincia AS provincia, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale ASC LIMIT 1",
      "time_total": 40.34495127573609,
      "time_generation": 24.732828877866268,
      "time_db": 0.9949133777990937,
      "time_synthesis": 12.44102506712079,
      "jaccard_index": 0.0,
      "query_similarity": 0.7951807228915663,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "provincia": "GR",
          "fatturatoTotale": 772.0
        }
      ],
      "mismatch_extra": [
        {
          "minProvincia": "AP"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-66-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Lista dei clienti il cui fatturato totale \u00e8 superiore al fatturato medio di tutti i clienti.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Type mismatch: expected ",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)\nWITH collect(doc) AS docs\nMATCH (c)-[:APPARTIENE_A]->(d:Ditta)\nWHERE NOT c IN [x IN nodes(docs) | x]\nRETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH count(DISTINCT c) AS totalCustomers, sum(dr.importo) AS totalRevenue WITH CASE WHEN totalCustomers = 0 THEN null ELSE totalRevenue / totalCustomers END AS avgRevenue WHERE avgRevenue IS NOT NULL MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS customerRevenue, avgRevenue WHERE customerRevenue > avgRevenue RETURN c.name AS cliente, customerRevenue ORDER BY customerRevenue DESC",
      "time_total": 57.74479169631377,
      "time_generation": 22.114966370165348,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-67-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il numero di documenti per ciascun tipo (codice).",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType)\nRETURN DISTINCT dt.codice AS doc_type, COUNT(doc) AS num_docs\nORDER BY num_docs DESC;",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType) RETURN dt.codice AS tipoDocumento, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC",
      "time_total": 28.915681939106435,
      "time_generation": 11.908418294042349,
      "time_db": 0.14769755862653255,
      "time_synthesis": 14.715490825939924,
      "jaccard_index": 0.0,
      "query_similarity": 0.7765567765567766,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-68-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il fatturato totale associato ai documenti di tipo 'FVC'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento {tipoOriginale: 'FVC'})-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleFatturato",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoFVC",
      "time_total": 40.5863709799014,
      "time_generation": 21.486052555032074,
      "time_db": 0.17029458796605468,
      "time_synthesis": 16.484521991573274,
      "jaccard_index": 0.0,
      "query_similarity": 0.7371007371007371,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "fatturatoFVC": 43854717.48000137
        }
      ],
      "mismatch_extra": [
        {
          "totaleFatturato": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-69-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale cliente ha ricevuto il maggior numero di note di credito (codice 'NCC')?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'NCC'\nWITH c, COUNT(dr) AS creditNotesCount\nORDER BY creditNotesCount DESC\nLIMIT 1\nRETURN c.name AS cliente",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'NCC'}) RETURN c.name AS cliente, count(doc) AS numeroNoteCredito ORDER BY numeroNoteCredito DESC LIMIT 1",
      "time_total": 39.2562619918026,
      "time_generation": 26.399519341997802,
      "time_db": 0.11901461984962225,
      "time_synthesis": 9.952422560192645,
      "jaccard_index": 0.0,
      "query_similarity": 0.3790523690773067,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "I.G.E.S. S.R.L.",
          "numeroNoteCredito": 49
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-70-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Calcola il valore medio di un documento per ciascun tipo (considerando solo il fatturato).",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Documento)-[:CONTIENE_RIGA]->(rd:RigaDocumento)\nWHERE rd.tipoValore = 'Fatturato' // filter by revenue\nWITH d, AVG(rd.importo) AS avg_revenue\nRETURN DISTINCT d.tipoOriginale AS tipo, avg_revenue AS average_value\nORDER BY avg_revenue DESC;",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH dt, doc, sum(dr.importo) AS valoreDocumento RETURN dt.codice AS tipoDocumento, avg(valoreDocumento) AS valoreMedio ORDER BY valoreMedio DESC",
      "time_total": 45.43390897708014,
      "time_generation": 21.497467431239784,
      "time_db": 2.1754338392056525,
      "time_synthesis": 19.305841849185526,
      "jaccard_index": 0.0,
      "query_similarity": 0.34750462107208874,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "tipoDocumento": "NDC",
          "valoreMedio": 6835.246666666666
        },
        {
          "tipoDocumento": "FVC",
          "valoreMedio": 2511.5810938663294
        },
        {
          "tipoDocumento": "NCC",
          "valoreMedio": 2662.121951219513
        }
      ],
      "mismatch_extra": [
        {
          "tipo": "FATT. IMMEDIATA VENDITA ROMA",
          "average_value": 333.33333333333337
        },
        {
          "tipo": "FATT. IMMEDIATA VENDITA PERUGIA",
          "average_value": 55.03666666666667
        },
        {
          "tipo": "FATT. IMMEDIATA VENDITA ROMA",
          "average_value": 25.28
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-71-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il cliente con il fatturato pi\u00f9 alto?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 42.77786290785298,
      "time_generation": 26.253572314977646,
      "time_db": 0.406413990072906,
      "time_synthesis": 14.060032540000975,
      "jaccard_index": 1.0,
      "query_similarity": 0.9737991266375546,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-72-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca 5 clienti situati a Perugia",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo)\nWHERE toLower(trim(l.localita)) = 'perugia'\nRETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 5",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.localita)) = 'perugia' RETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 5",
      "time_total": 21.49691410921514,
      "time_generation": 7.494094244670123,
      "time_db": 0.05070401495322585,
      "time_synthesis": 12.001397895161062,
      "jaccard_index": 1.0,
      "query_similarity": 1.0,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-73-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 5 prodotti pi\u00f9 popolari in termini di quantit\u00e0 venduta",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nRETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 5",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 5",
      "time_total": 46.2823285702616,
      "time_generation": 23.4945266880095,
      "time_db": 0.6145503977313638,
      "time_synthesis": 19.931437603197992,
      "jaccard_index": 1.0,
      "query_similarity": 0.9977628635346756,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-74-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Dimmi il fatturato di ciascuna azienda.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(rd:RigaDocumento)\nWHERE rd.tipoValore = 'Fatturato'\nWITH c, SUM(rd.importo) AS revenue\nRETURN DISTINCT c.name AS cliente, revenue ORDER BY revenue DESC LIMIT 10",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 41.300738024991006,
      "time_generation": 20.51694748410955,
      "time_db": 0.6723830467090011,
      "time_synthesis": 17.8838159609586,
      "jaccard_index": 0.0,
      "query_similarity": 0.5921325051759835,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "4",
          "fatturatoTotale": 1268387.26
        },
        {
          "ditta": "1",
          "fatturatoTotale": 3871373.63
        },
        {
          "ditta": "2",
          "fatturatoTotale": 37155291.67000106
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "UMBRIAFRIGO SRL",
          "revenue": 1838597.939999996
        },
        {
          "cliente": "UMBRIAFRIGO SRL",
          "revenue": 1251237.26
        },
        {
          "cliente": "GESPAC SRL",
          "revenue": 949614.7399999977
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-75-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanto ho speso per acquistare il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE toLower(trim(dr.descrizione)) = 'gas freon solstice n40 r448a'\nRETURN sum(dr.importo) AS totaleAcquistato",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' RETURN sum(dr.importo) AS costoTotaleAcquisto",
      "time_total": 26.230507550295442,
      "time_generation": 14.579867304302752,
      "time_db": 0.3164848629385233,
      "time_synthesis": 8.51491522230208,
      "jaccard_index": 0.0,
      "query_similarity": 0.7981220657276995,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "costoTotaleAcquisto": 578501.2
        }
      ],
      "mismatch_extra": [
        {
          "totaleAcquistato": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-76-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quanto ho guadagnato vendendo il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS totaleVenduto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS totaleVenduto",
      "time_total": 31.3219180139713,
      "time_generation": 17.62880948698148,
      "time_db": 0.618679434992373,
      "time_synthesis": 10.284244101960212,
      "jaccard_index": 1.0,
      "query_similarity": 0.9928057553956835,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": true,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-77-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali aziende vendono prodotti della famiglia 'CENTRALI FRIGO'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)-[:APPARTIENE_A]->(:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore)-[:INCLUSA_IN]->(f:Famiglia)\nWHERE toLower(trim(f.nome)) = 'centrali frigo'\nRETURN DISTINCT d.dittaId AS ditta\nORDER BY ditta\nLIMIT 10",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' RETURN DISTINCT d.dittaId AS ditta ORDER BY ditta",
      "time_total": 51.555147119797766,
      "time_generation": 33.990800116211176,
      "time_db": 0.21075835265219212,
      "time_synthesis": 14.884992465842515,
      "jaccard_index": 0.0,
      "query_similarity": 0.6489563567362429,
      "specialist": "DITTE_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "4"
        },
        {
          "ditta": "2"
        },
        {
          "ditta": "1"
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-78-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 l'importo medio per riga documento nelle fatture di vendita?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.ArithmeticError} {message: / by zero}",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND doc.tipoOriginale = 'Fatturato'\nWITH sum(dr.importo) AS totaleImporti, count(*) AS numeroDocumenti\nRETURN avg(totaleImporti / numeroDocumenti) AS mediaImportoPerLinea",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN avg(dr.importo) AS importoMedioRiga",
      "time_total": 41.972011951263994,
      "time_generation": 30.77623267006129,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-79-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per ogni azienda, classifica il suo fatturato totale come 'Alto' se supera i 10 milioni, 'Medio' se \u00e8 tra 1 e 10 milioni, e 'Basso' altrimenti.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)\nWITH d\nMATCH (c:Cliente)-[:APPARTIENE_A]->(d)\nWHERE c.creditlimit > 10000000\nRETURN 'High' AS revenue_class\n\nUNION ALL\n\nMATCH (d:Ditta)\nWITH d\nMATCH (c:Cliente)-[:APPARTIENE_A]->(d)\nWHERE c.creditlimit >= 1000000 AND c.creditlimit <= 10000000\nRETURN 'Medium' AS revenue_class\n\nUNION ALL\n\nMATCH (d:Ditta)\nWITH d\nMATCH (c:Cliente)-[:APPARTIENE_A]->(d)\nWHERE c.creditlimit < 1000000\nRETURN 'Low' AS revenue_class",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, sum(dr.importo) AS fatturatoTotale RETURN d.dittaId AS ditta, fatturatoTotale, CASE WHEN fatturatoTotale > 10000000 THEN 'Alto' WHEN fatturatoTotale > 1000000 THEN 'Medio' ELSE 'Basso' END AS categoriaFatturato",
      "time_total": 41.913666328880936,
      "time_generation": 26.14712647534907,
      "time_db": 0.9809876470826566,
      "time_synthesis": 10.902114181779325,
      "jaccard_index": 0.0,
      "query_similarity": 0.05236907730673317,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "1",
          "fatturatoTotale": 3871373.63,
          "categoriaFatturato": "Medio"
        },
        {
          "ditta": "4",
          "fatturatoTotale": 1268387.26,
          "categoriaFatturato": "Medio"
        },
        {
          "ditta": "3",
          "fatturatoTotale": 2235052.6599999964,
          "categoriaFatturato": "Medio"
        }
      ],
      "mismatch_extra": [
        {
          "revenue_class": "Low"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-80-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il primo e l'ultimo documento di vendita mai registrato per il cliente 'ACME SRL'?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente {name: 'ACME SRL'})-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWITH doc, min(doc.dataEmissione) AS firstDate, max(doc.dataEmissione) AS lastDate\nRETURN firstDate AS firstDocument, lastDate AS lastDocument;",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento) WHERE toLower(trim(c.name)) = 'acme srl' RETURN min(doc.dataEmissione) AS primoDocumento, max(doc.dataEmissione) AS ultimoDocumento",
      "time_total": 33.907090176828206,
      "time_generation": 19.76525134406984,
      "time_db": 0.13628323236480355,
      "time_synthesis": 11.320941181853414,
      "jaccard_index": 0.0,
      "query_similarity": 0.29836829836829837,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "primoDocumento": null,
          "ultimoDocumento": null
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-81-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la media del fatturato mensile per il cliente 'ACME SRL' nel 2024?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': e",
      "generated_cypher": "MATCH (c:Cliente {name: \"ACME SRL\"})-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.dataEmissione.year = 2024 AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, MONTH(doc.dataEmissione) AS mese, sum(dr.importo) AS fatturatoMese\nGROUP BY c, mese\nORDER BY mese ASC\nRETURN avg(fatturatoMese) AS mediaFatturatoMensile",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE toLower(trim(c.name)) = 'l\\'abbondanza srl' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year = 2024 WITH date(doc.dataEmissione).month AS mese, sum(dr.importo) AS fatturatoMensile RETURN avg(fatturatoMensile) AS mediaFatturatoMensile",
      "time_total": 64.22051804931834,
      "time_generation": 28.613197322003543,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-82-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per i primi 3 clienti per fatturato, mostra il loro prodotto pi\u00f9 acquistato per valore.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'a2': expe",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nORDER BY totaleVenduto DESC\nLIMIT 3\nMATCH (c)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE a.descrizione IN (\n  SELECT a2.descrizione\n  FROM (MATCH (c)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS descrizione) AS subquery\n  ORDER BY COUNT(*) DESC\n  LIMIT 1\n)\nRETURN c.name AS cliente, a.descrizione AS prodotto, totaleVenduto AS fatturato\nORDER BY fatturato DESC",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 3 MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr2.tipoValore = 'Fatturato' AND dr2.importo > 0 WITH c, a, sum(dr2.importo) AS valoreProdotto ORDER BY c.name, valoreProdotto DESC WITH c, head(collect({prodotto: a.descrizione, valore: valoreProdotto})) AS topProdotto RETURN c.name AS cliente, topProdotto.prodotto AS prodottoTop, topProdotto.valore AS valoreTop ORDER BY c.name",
      "time_total": 79.88598360680044,
      "time_generation": 29.30559960566461,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "SALES_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-83-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quali clienti hanno effettuato ordini ma non hanno ancora ricevuto una fattura?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Ordinato' // filter for orders\nWITH f, collect(dr) AS docs\nMATCH (c:Cliente)-[:HAS_ADDRESS]->(:Luogo)\nWHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)\nRETURN c.name AS cliente\nORDER BY cliente\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Ordinato'}) WITH DISTINCT c MATCH (c) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento {tipoValore: 'Fatturato'}) RETURN c.name AS clienteSenzaFattura",
      "time_total": 48.20235820394009,
      "time_generation": 28.354455791879445,
      "time_db": 5.690292846877128,
      "time_synthesis": 11.952811494935304,
      "jaccard_index": 0.0,
      "query_similarity": 0.21565217391304348,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "clienteSenzaFattura": "MACELLERIA SAN SECONDO"
        },
        {
          "clienteSenzaFattura": "HONG KONG UGREEN LIMITED"
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "\" LA BOTTEGA \" SNC"
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-84-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il fornitore principale per ogni famiglia di prodotto, in base al valore acquistato?",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': e",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\n-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(ff:Famiglia)\n\nWITH ff, sum(dr.importo) AS totaleAcquistato\n\nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore)\nWHERE f.ragioneSociale = gf.ragioneSociale\nGROUP BY gf.ragioneSociale, ff.nome\n\nORDER BY totaleAcquistato DESC\n\nRETURN DISTINCT gf.ragioneSociale AS mainSupplier, ff.nome AS productFamily, totaleAcquistato AS purchaseValue\nLIMIT 10;",
      "expected_cypher": "MATCH (fam:Famiglia)<-[:INCLUSA_IN]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore) WITH fam, gf, sum(dr.importo) AS valoreAcquistato ORDER BY fam.nome, valoreAcquistato DESC WITH fam, collect({fornitore: gf.ragioneSociale, valore: valoreAcquistato})[0] AS fornitoreTop RETURN fam.nome AS famiglia, fornitoreTop.fornitore AS fornitorePrincipale",
      "time_total": 110.02718586707488,
      "time_generation": 33.407804793678224,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-85-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore totale degli ordini in sospeso (ordinati ma non fatturati)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Ordinato' // Filter for outstanding orders\nWITH f, sum(dr.importo) AS totaleAcquistato\nRETURN totaleAcquistato AS totalValueOfOutstandingOrders\nORDER BY totaleAcquistato DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Ordinato' WITH c, doc, sum(dr.importo) AS valoreOrdinato WHERE NOT (doc)<-[:CONTIENE_RIGA]-(:RigaDocumento {tipoValore:'Fatturato'}) RETURN sum(valoreOrdinato) AS totaleOrdiniSospesi",
      "time_total": 43.5600923076272,
      "time_generation": 22.86199136218056,
      "time_db": 0.2938002566806972,
      "time_synthesis": 18.01179103087634,
      "jaccard_index": 0.0,
      "query_similarity": 0.044673539518900345,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "totaleOrdiniSospesi": 2376823.710000001
        }
      ],
      "mismatch_extra": [
        {
          "totalValueOfOutstandingOrders": 1267140.0099999995
        },
        {
          "totalValueOfOutstandingOrders": 200660.28999999998
        },
        {
          "totalValueOfOutstandingOrders": 1829326.7900000003
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-86-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i clienti che acquistano pi\u00f9 di 10 articoli unici diversi.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Ordinato'\nWITH c, collect(distinct dr.articoloId) AS uniqueProducts\nWHERE size(uniqueProducts) > 10\nRETURN c.name AS cliente, size(uniqueProducts) AS numUniqueProducts\nORDER BY numUniqueProducts DESC\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WITH c, count(DISTINCT a) AS numeroArticoliUnici WHERE numeroArticoliUnici > 10 RETURN c.name AS cliente, numeroArticoliUnici ORDER BY numeroArticoliUnici DESC",
      "time_total": 61.62500009313226,
      "time_generation": 19.55763765098527,
      "time_db": 28.425546944141388,
      "time_synthesis": 11.206279611680657,
      "jaccard_index": 0.0,
      "query_similarity": 0.5286195286195287,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "DISCOUNT TRE SRL",
          "numeroArticoliUnici": 26
        },
        {
          "cliente": "ELLE DISCOUNT SRL",
          "numeroArticoliUnici": 32
        },
        {
          "cliente": "CAR.MA SRL",
          "numeroArticoliUnici": 60
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-87-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per il prodotto pi\u00f9 venduto per quantit\u00e0, qual \u00e8 il suo costo medio di acquisto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE toLower(trim(f.ragioneSociale)) = 'best-selling product'\nWITH f, sum(dr.importo) AS totaleAcquistato\nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore)\nRETURN avg(totaleAcquistato) AS mediaCostoAcquisto",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WITH a, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 1 MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) RETURN a.descrizione AS prodotto, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedioUnitario",
      "time_total": 50.981541940011084,
      "time_generation": 31.469463229645044,
      "time_db": 0.16737526515498757,
      "time_synthesis": 16.737773013301194,
      "jaccard_index": 0.0,
      "query_similarity": 0.22959183673469388,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "prodotto": "Articolo placeholder: ID_NON_DISPONIBILE",
          "costoMedioUnitario": 272.7513515257551
        }
      ],
      "mismatch_extra": [
        {
          "mediaCostoAcquisto": null
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-88-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i fornitori che trattano solo prodotti di una singola famiglia.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'WHERE': e",
      "generated_cypher": "MATCH (f:Fornitore)-[:RAGGRUPPATO_SOTTO]->(gf:GruppoFornitore)\nWHERE NOT (f)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(f2:Famiglia)\nWHERE f.ragioneSociale = gf.ragioneSociale\nRETURN DISTINCT f.ragioneSociale AS supplier, gf.nome AS family\nORDER BY supplier\nLIMIT 10;",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WITH gf, count(DISTINCT fam) AS numeroFamiglie WHERE numeroFamiglie = 1 RETURN gf.ragioneSociale AS fornitoreMonoFamiglia",
      "time_total": 81.44068177510053,
      "time_generation": 24.714957769960165,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-89-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 la percentuale di fatturato generata dai clienti nella regione 'Umbria' sul totale?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo)\nWHERE l.region = 'Umbria'\nWITH c\nMATCH (c)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(rd:RigaDocumento)\nWHERE rd.tipoValore = 'Fatturato' // or Ordinato, DDT depending on the question\nRETURN SUM(rd.importo) AS totaleUmbria",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo),(c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH sum(dr.importo) AS totaleFatturato,  sum(CASE WHEN toLower(trim(l.regione)) = 'umbria' THEN dr.importo ELSE 0 END) AS fatturatoUmbria RETURN CASE WHEN totaleFatturato = 0 THEN 0.0 ELSE (fatturatoUmbria * 100.0 / totaleFatturato) END AS percentualeUmbria",
      "time_total": 36.58939669886604,
      "time_generation": 21.63482046779245,
      "time_db": 0.17532632406800985,
      "time_synthesis": 11.787145308684558,
      "jaccard_index": 0.0,
      "query_similarity": 0.4498567335243553,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "percentualeUmbria": 58.464609552069845
        }
      ],
      "mismatch_extra": [
        {
          "totaleUmbria": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-90-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Trova il cliente con il valore medio degli ordini pi\u00f9 alto.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, avg(dr.importo) AS mediaOrdine\nORDER BY mediaOrdine DESC\nRETURN c.name AS cliente, mediaOrdine AS mediaOrdine\nLIMIT 1;",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, doc, sum(dr.importo) AS valoreOrdine RETURN c.name AS cliente, avg(valoreOrdine) AS valoreMedioOrdine ORDER BY valoreMedioOrdine DESC LIMIT 1",
      "time_total": 45.85765209514648,
      "time_generation": 29.617164633236825,
      "time_db": 0.583383372053504,
      "time_synthesis": 13.11593996686861,
      "jaccard_index": 1.0,
      "query_similarity": 0.6270270270270271,
      "specialist": "SALES_CYCLE",
      "jaccard_success": true,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": "strict",
      "strict_success": true
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-91-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami i 3 mesi con il maggior numero di documenti di acquisto registrati.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input 'GROUP': e",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)\nWHERE doc.dataEmissione IS NOT NULL\nWITH doc, MONTH(doc.dataEmissione) AS mese\nGROUP BY mese\nORDER BY COUNT(*) DESC\nLIMIT 3\nRETURN mese AS mese, COUNT(*) AS numeroDocumenti",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(doc:Documento) RETURN doc.dataEmissione.year AS anno, doc.dataEmissione.month AS mese, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC LIMIT 3",
      "time_total": 56.78806458925828,
      "time_generation": 28.14518312783912,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-92-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Ci sono prodotti venduti a un prezzo inferiore al loro costo medio di acquisto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH a, avg(dr.importo) AS mediaPrezzo\nMATCH (c)-[:HA_RICEVUTO]->(doc)-[:CONTIENE_RIGA]->(dr)-[:RIGUARDA_ARTICOLO]->(a)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo < mediaPrezzo\nRETURN a.descrizione AS prodotto, count(*) AS quantitaVenduta\nORDER BY quantitaVenduta DESC\nLIMIT 10",
      "expected_cypher": "MATCH (a:Articolo) OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WITH a, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedio OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente) WHERE dr_ven.tipoValore = 'Fatturato' AND dr_ven.importo > 0 WITH a, costoMedio, avg(CASE WHEN dr_ven.quantita = 0 OR dr_ven.quantita IS NULL THEN null ELSE dr_ven.importo / dr_ven.quantita END) AS prezzoMedioVendita WHERE prezzoMedioVendita < costoMedio RETURN a.descrizione AS prodottoInPerdita",
      "time_total": 61.15061365021393,
      "time_generation": 36.161862410604954,
      "time_db": 1.1562095079571009,
      "time_synthesis": 20.786150211934,
      "jaccard_index": 0.0,
      "query_similarity": 0.20294882914137033,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "prodottoInPerdita": "CENTRALINA DIXELL"
        },
        {
          "prodottoInPerdita": "CENTRALINA MCX08M2 DANFOSS"
        },
        {
          "prodottoInPerdita": "ADATTATORE 02K46OS24"
        }
      ],
      "mismatch_extra": [
        {
          "prodotto": "Marco Celeschi",
          "quantitaVenduta": 850
        },
        {
          "prodotto": "Articolo placeholder: ID_NON_DISPONIBILE",
          "quantitaVenduta": 11590
        },
        {
          "prodotto": "MANODOPERA TECNICO",
          "quantitaVenduta": 733
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-93-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale tipo di documento (codice) \u00e8 pi\u00f9 frequentemente associato al ciclo di acquisto?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWITH f, COUNT(DISTINCT doc) AS documentoCount\nORDER BY documentoCount DESC\nLIMIT 1\nRETURN f.codiceFornitore AS fornitore, documentoCount AS documentoCount",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) RETURN dt.codice AS tipoDocumento, count(doc) AS frequenza ORDER BY frequenza DESC LIMIT 1",
      "time_total": 41.72139855893329,
      "time_generation": 25.011812433600426,
      "time_db": 0.1824513296596706,
      "time_synthesis": 13.883305958937854,
      "jaccard_index": 0.0,
      "query_similarity": 0.4,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "tipoDocumento": "OF",
          "frequenza": 6571
        }
      ],
      "mismatch_extra": [
        {
          "fornitore": null,
          "documentoCount": 2832
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-94-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i fornitori situati in un luogo dove non abbiamo clienti.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: PatternExpressions are n",
      "generated_cypher": "MATCH (f:Fornitore)-[:SI_TROVA_A]->(l:Luogo)\nWHERE NOT (c:Cliente)-[:HAS_ADDRESS]->(l)\nRETURN DISTINCT f.ragioneSociale AS fornitore\nORDER BY fornitore\nLIMIT 10",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f:Fornitore)-[:SI_TROVA_A]->(lf:Luogo) WHERE NOT EXISTS { MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo {localita: lf.localita}) } RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER BY fornitore",
      "time_total": 44.66632195003331,
      "time_generation": 16.64568183105439,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-95-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quante note di credito clienti (NCC) abbiamo emesso in totale?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)\nWHERE doc.tipoOriginale = 'Credit Note'\nRETURN COUNT(DISTINCT c.name) AS total_credit_notes\nORDER BY total_credit_notes DESC\nLIMIT 10",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'NCC'}) RETURN count(doc) AS numeroNoteCredito",
      "time_total": 37.945662058889866,
      "time_generation": 21.46956526208669,
      "time_db": 0.09767978824675083,
      "time_synthesis": 14.296884229872376,
      "jaccard_index": 0.0,
      "query_similarity": 0.3873239436619718,
      "specialist": "GENERAL_QUERY",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "numeroNoteCredito": 639
        }
      ],
      "mismatch_extra": [
        {
          "total_credit_notes": 0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-96-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami tutti gli ordini fornitori (OF) per maggio 2024.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Variable `doc` not defin",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE doc.dataEmissione >= datetime(\"2024-05-01\") AND doc.dataEmissione <= datetime(\"2024-05-31\")\nWITH f, collect(doc) AS docs\nMATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(f)\nRETURN gf.ragioneSociale AS supplier, count(DISTINCT doc) AS num_orders\nORDER BY num_orders DESC\nLIMIT 10;",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OF'}) WHERE doc.dataEmissione.year = 2024 AND doc.dataEmissione.month = 5 RETURN doc.documentoId AS ordine",
      "time_total": 52.538397539872676,
      "time_generation": 24.482494747731835,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-97-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore totale delle fatture fornitori (FFA) ricevute?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWITH f, sum(dr.importo) AS totale\nRETURN totale AS valoreTotaleFFA\nORDER BY valoreTotaleFFA DESC\nLIMIT 10",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FFA'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) RETURN sum(dr.importo) AS totaleFattureFornitore",
      "time_total": 47.26438110182062,
      "time_generation": 25.918858502991498,
      "time_db": 0.23518212884664536,
      "time_synthesis": 18.579758538864553,
      "jaccard_index": 0.0,
      "query_similarity": 0.5100286532951289,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "totaleFattureFornitore": 0.0
        }
      ],
      "mismatch_extra": [
        {
          "valoreTotaleFFA": 1267140.0099999995
        },
        {
          "valoreTotaleFFA": 200660.28999999998
        },
        {
          "valoreTotaleFFA": 1829326.7900000003
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-98-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i clienti a cui abbiamo inviato una nota di consegna clienti (DDTV) a Roma.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input ':': expec",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento {tipoOriginale: 'DDT'})-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'DDT' AND toLower(trim(l.localita)) = 'roma'\nWITH f\nMATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo {regione: 'Lazio', localita: 'Roma'})\nWHERE c-[:APPARTIENE_A]->(:Ditta)\nRETURN DISTINCT c.name AS cliente\nORDER BY cliente\nLIMIT 10",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'DDTV'}) WHERE toLower(trim(doc.tipoOriginale)) CONTAINS 'roma' RETURN DISTINCT c.name AS cliente",
      "time_total": 66.02714646887034,
      "time_generation": 27.022979414090514,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-99-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore fatturato presente solo nelle fatture clienti (FVC)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS FVC",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' RETURN sum(dr.importo) AS totaleFatturatoInFVC",
      "time_total": 37.3782249330543,
      "time_generation": 16.457082560285926,
      "time_db": 0.46742970822378993,
      "time_synthesis": 18.01665445929393,
      "jaccard_index": 0.0,
      "query_similarity": 0.6703910614525139,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "totaleFatturatoInFVC": 43854717.48000137
        }
      ],
      "mismatch_extra": [
        {
          "FVC": 44530105.22000251
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-100-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il totale ordinato attraverso gli ordini clienti (OC) per la ditta '1'.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente {name: 'Company 1'})-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totale\nRETURN c.name AS cliente, totale\nORDER BY totale DESC",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Ordinato' RETURN sum(dr.importo) AS totaleOrdinatoDitta1",
      "time_total": 44.22265944862738,
      "time_generation": 28.429689020384103,
      "time_db": 0.17805634904652834,
      "time_synthesis": 13.046072549186647,
      "jaccard_index": 0.0,
      "query_similarity": 0.1908548707753479,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "totaleOrdinatoDitta1": 0
        }
      ],
      "mismatch_extra": []
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-101-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Qual \u00e8 il valore medio delle righe fatturate nelle note di consegna clienti (DDTV)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleVenduto\nRETURN avg(totaleVenduto) AS mediaVenduto",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'DDTV'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Bollato' RETURN avg(dr.importo) AS valoreMedioBollato",
      "time_total": 47.79183618910611,
      "time_generation": 28.616106025874615,
      "time_db": 0.5208343579433858,
      "time_synthesis": 15.5595019669272,
      "jaccard_index": 0.0,
      "query_similarity": 0.2141119221411192,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "valoreMedioBollato": 287.930263878516
        }
      ],
      "mismatch_extra": [
        {
          "mediaVenduto": 59771.953315436236
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-102-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Chi \u00e8 il cliente con il valore fatturato pi\u00f9 alto considerando solo le fatture immediate (FVC)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturato\nORDER BY fatturato DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS totale ORDER BY totale DESC LIMIT 1",
      "time_total": 34.89604749903083,
      "time_generation": 21.037113964091986,
      "time_db": 0.589746339712292,
      "time_synthesis": 10.842462277039886,
      "jaccard_index": 0.0,
      "query_similarity": 0.3727454909819639,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "cliente": "L'ABBONDANZA SRL",
          "totale": 6071834.069999974
        }
      ],
      "mismatch_extra": [
        {
          "cliente": "L'ABBONDANZA SRL",
          "fatturato": 6077563.659999978
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-103-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Per il cliente 'ACME SRL', confronta il totale ordinato e il totale fatturato.",
      "success": false,
      "error": "Syntax error: {code: Neo.ClientError.Statement.SyntaxError} {message: Variable `totaleOrdini` ",
      "generated_cypher": "MATCH (c:Cliente {name: 'ACME SRL'})\nWHERE c.customertypecode = 'Customer'\nWITH c\nMATCH (c)-[:HA_RICEVUTO]->(d:Documento)\nWHERE d.tipoOriginale = 'Fatturato' AND d.dataEmissione >= date('2022-01-01')\nWITH c, sum(d.importo) AS totaleOrdini\nMATCH (c)-[:HA_RICEVUTO]->(dr:RigaDocumento {tipoValore: 'Fatturato'})\nWHERE dr.quantita > 0 AND dr.importo > 0\nWITH c, sum(dr.importo) AS totaleInvoiced\nRETURN c.name AS cliente, totaleOrdini AS orderedTotal, totaleInvoiced AS invoicedTotal\nORDER BY totaleInvoiced DESC\nLIMIT 10;",
      "expected_cypher": "MATCH (c:Cliente) WHERE toLower(trim(c.name)) = 'acme srl' OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_ord:RigaDocumento {tipoValore: 'Ordinato'}) WITH c, sum(dr_ord.importo) AS totaleOrdinato OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento {tipoValore: 'Fatturato'}) WHERE dr_fat.importo > 0 RETURN totaleOrdinato, sum(dr_fat.importo) AS totaleFatturato",
      "time_total": 76.30166927212849,
      "time_generation": 39.602546234149486,
      "time_db": null,
      "time_synthesis": null,
      "jaccard_index": null,
      "query_similarity": null,
      "specialist": "CROSS_DOMAIN",
      "jaccard_success": null,
      "similarity_success": null,
      "examples_top_k": null,
      "success_reason": null
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-104-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Elenca i documenti d'ordine clienti (OC) che non sono ancora stati completamente fatturati.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE NOT doc.tipoOriginale = 'Fattura'\nWITH f, COUNT(DISTINCT doc) AS documentoCount\nRETURN f.ragioneSociale AS fornitore, documentoCount AS documentoCount\nORDER BY documentoCount DESC\nLIMIT 10",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'OC'}) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento {tipoValore: 'Ordinato'}) WITH doc, sum(dr.importo) AS valoreOrdinato MATCH (doc)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento {tipoValore: 'Fatturato'}) WITH doc, valoreOrdinato, sum(dr_fat.importo) AS valoreFatturato WHERE valoreOrdinato > valoreFatturato RETURN doc.documentoId AS ordineNonSaldato",
      "time_total": 45.025580674409866,
      "time_generation": 21.3938578562811,
      "time_db": 0.2855221848003566,
      "time_synthesis": 20.71888204291463,
      "jaccard_index": 0.0,
      "query_similarity": 0.1282798833819242,
      "specialist": "PURCHASE_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [],
      "mismatch_extra": [
        {
          "fornitore": "SALDOGAS SRL",
          "documentoCount": 436
        },
        {
          "fornitore": "AMAZON EU S.A.R.L., SUCCURSALE ITALIANA",
          "documentoCount": 280
        },
        {
          "fornitore": "MORELLI SPA",
          "documentoCount": 2832
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-105-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Quale tipo di documento (nome) ha il valore medio pi\u00f9 alto per riga (considerando solo i valori fatturati)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH doc, avg(dr.importo) AS mediaImporto\nMATCH (doc)-[:IS_TYPE]->(dt:DocType)\nRETURN dt.nome AS tipoDocumento, mediaImporto AS media\nORDER BY media DESC\nLIMIT 1;",
      "expected_cypher": "MATCH (doc:Documento)-[:IS_TYPE]->(dt:DocType) MATCH (doc)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN dt.nome AS nomeTipoDocumento, avg(dr.importo) AS valoreMedioRiga ORDER BY valoreMedioRiga DESC LIMIT 1",
      "time_total": 39.83343736734241,
      "time_generation": 23.94235632289201,
      "time_db": 0.6218448439612985,
      "time_synthesis": 11.771038436796516,
      "jaccard_index": 0.0,
      "query_similarity": 0.26785714285714285,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "nomeTipoDocumento": "Nota Debito Cliente",
          "valoreMedioRiga": 6835.246666666666
        }
      ],
      "mismatch_extra": [
        {
          "tipoDocumento": "Fattura Cliente",
          "media": 565000.0
        }
      ]
    },
    {
      "config": "specialist-llama3",
      "test_id": "TEST-106-Genera la query Cypher per rispondere a questo input in italiano",
      "question": "Mostrami il totale fatturato e il totale ordinato per ciascuna ditta.",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore IN ['Fatturato', 'Ordinato']\nRETURN d.dittaId AS ditta, \n       SUM(CASE WHEN dr.tipoValore = 'Fatturato' THEN dr.importo ELSE 0 END) AS totaleInvoiced,\n       SUM(CASE WHEN dr.tipoValore = 'Ordinato' THEN dr.quantita ELSE 0 END) AS totaleOrdered\nORDER BY ditta;",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) RETURN d.dittaId AS ditta, sum(CASE dr.tipoValore WHEN 'Fatturato' THEN dr.importo ELSE 0 END) AS totaleFatturato, sum(CASE dr.tipoValore WHEN 'Ordinato' THEN dr.importo ELSE 0 END) AS totaleOrdinato ORDER BY ditta ASC",
      "time_total": 54.577814468648285,
      "time_generation": 31.190293373074383,
      "time_db": 0.5094754677265882,
      "time_synthesis": 20.612477294169366,
      "jaccard_index": 0.6,
      "query_similarity": 0.7306064880112835,
      "specialist": "SALES_CYCLE",
      "jaccard_success": false,
      "similarity_success": false,
      "examples_top_k": null,
      "success_reason": null,
      "strict_success": false,
      "mismatch_missing": [
        {
          "ditta": "2",
          "totaleFatturato": 37155291.6700004,
          "totaleOrdinato": 2376823.7100000014
        }
      ],
      "mismatch_extra": [
        {
          "ditta": "2",
          "totaleInvoiced": 37155291.6700004,
          "totaleOrdered": 0.0
        }
      ]
    }
  ]
}