{
  "config": "hybrid-gpt4o-mini",
  "approach": "hybrid",
  "config_name": "gpt4o-mini",
  "timestamp": "20251017_094902",
  "summary": {
    "total": 18,
    "success": 16,
    "failures": 2,
    "accuracy": 88.88888888888889,
    "avg_time": 12.557488051838138
  },
  "results": [
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_00_FATTURATO_CLIENTE_SPECIFICO",
      "question": "Qual \u00e8 il fatturato totale del cliente BARONE DI FERRANTE EZIO?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN sum(dr.importo) AS fatturatoTotale",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS fatturatoTotale",
      "time_total": 15.279446308966726,
      "time_generation": 3.8419718760997057,
      "time_db": 0.5203245161101222,
      "time_synthesis": 8.741089671850204
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_01_CLIENTE_TOP_FATTURATO",
      "question": "Chi \u00e8 il cliente con il maggior fatturato?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale\nORDER BY fatturatoTotale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN c.name AS cliente, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC LIMIT 1",
      "time_total": 9.794757163152099,
      "time_generation": 2.951904733199626,
      "time_db": 0.9916220670565963,
      "time_synthesis": 5.062048785854131
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_02_LISTA_CLIENTI_PER_REGIONE",
      "question": "Elenca 5 clienti che si trovano a Perugia",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo)\nWHERE toLower(trim(l.localita)) = 'perugia'\nRETURN DISTINCT c.name AS cliente\nORDER BY cliente\nLIMIT 5",
      "expected_cypher": "MATCH (c:Cliente)-[:HAS_ADDRESS]->(l:Luogo) WHERE toLower(trim(l.localita)) = 'perugia' RETURN DISTINCT c.name AS cliente ORDER BY cliente LIMIT 5",
      "time_total": 9.783973213750869,
      "time_generation": 1.3412914252839983,
      "time_db": 0.3035875419154763,
      "time_synthesis": 7.19035963434726
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_03_ANALISI_COMPLESSA_TOP_N",
      "question": "Mostrami i 5 prodotti pi\u00f9 popolari in termini di quantit\u00e0 venduta",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nRETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 5",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) RETURN a.descrizione AS prodotto, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 5",
      "time_total": 14.942381580825895,
      "time_generation": 2.1569520430639386,
      "time_db": 0.9055057116784155,
      "time_synthesis": 10.646521759219468
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_04_FATTURATO_PER_DITTA",
      "question": "Dimmi il fatturato di ogni ditta.",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale \nORDER BY fatturatoTotale DESC",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN d.dittaId AS ditta, sum(dr.importo) AS fatturatoTotale ORDER BY fatturatoTotale DESC",
      "time_total": 16.123043639119714,
      "time_generation": 3.1240592948161066,
      "time_db": 0.8380662673152983,
      "time_synthesis": 10.573339546099305
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_05_ANNO_TOP_FATTURATO",
      "question": "Il fatturato di ogni ditta, nel loro anno migliore",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)\nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0\nWITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale\nORDER BY d.dittaId, fatturatoAnnuale DESC\nWITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati\nRETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH d, doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY d.dittaId, fatturatoAnnuale DESC WITH d, collect({anno: anno, fatturato: fatturatoAnnuale}) AS fatturatiOrdinati RETURN d.dittaId AS ditta, fatturatiOrdinati[0].anno AS annoTop, fatturatiOrdinati[0].fatturato AS fatturatoMassimo",
      "time_total": 20.061583966948092,
      "time_generation": 3.3177782790735364,
      "time_db": 1.1209015189670026,
      "time_synthesis": 13.903090596199036
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_06_FAMIGLIA_PIU_ACQUISTATA",
      "question": "Qual \u00e8 la famiglia di prodotti pi\u00f9 acquistata?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia)\nRETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale\nORDER BY quantitaTotale DESC\nLIMIT 1",
      "expected_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(sf:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) RETURN fam.nome AS famiglia, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT 1",
      "time_total": 11.648821886163205,
      "time_generation": 2.298933975864202,
      "time_db": 0.9219666561111808,
      "time_synthesis": 7.595921766012907
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_07_PRODOTTO_PIU_VENDUTO",
      "question": "Qual \u00e8 il prodotto pi\u00f9 venduto in generale (per valore)?",
      "success": false,
      "error": "Results mismatch",
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE dr.importo > 0 \nRETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto \nORDER BY valoreVenduto DESC \nLIMIT 1",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN a.descrizione AS prodotto, sum(dr.importo) AS valoreVenduto ORDER BY valoreVenduto DESC LIMIT 1",
      "time_total": 14.915090695023537,
      "time_generation": 3.215276282746345,
      "time_db": 0.6723829340189695,
      "time_synthesis": 10.149654306937009
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_08_COSTO_ACQUISTO_PRODOTTO",
      "question": "A quanto ho acquistato il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' \nRETURN sum(dr.importo) AS prezzoAcquisto",
      "expected_cypher": "MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(dr:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' RETURN sum(dr.importo) AS costoTotaleAcquisto",
      "time_total": 9.392442687880248,
      "time_generation": 1.9920419999398291,
      "time_db": 0.42005698708817363,
      "time_synthesis": 6.160876933950931
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_09_PREZZO_VENDITA_PRODOTTO",
      "question": "A quanto l'ho venduto il prodotto GAS FREON SOLSTICE N40 R448A?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) \nWHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN sum(dr.importo) AS prezzoVendita",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN sum(dr.importo) AS totaleVenduto",
      "time_total": 11.937876673880965,
      "time_generation": 3.670949107967317,
      "time_db": 0.6132314098067582,
      "time_synthesis": 6.805543596390635
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_10_TREND_DITTA",
      "question": "Attualmente la ditta 2 \u00e8 in perdita o in crescita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '2'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year IN [date().year, date().year - 1] \nRETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale \nORDER BY anno DESC",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '2'})<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 AND doc.dataEmissione.year IN [date().year, date().year - 1] RETURN doc.dataEmissione.year AS anno, sum(dr.importo) AS fatturatoAnnuale ORDER BY anno DESC",
      "time_total": 15.017752561718225,
      "time_generation": 2.4705551117658615,
      "time_db": 0.9903226080350578,
      "time_synthesis": 10.78532657213509
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_11_DITTA_PER_FAMIGLIA",
      "question": "Quali ditte vendono prodotti della famiglia 'CENTRALI FRIGO'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) \nWHERE toLower(trim(fam.nome)) = 'centrali frigo' \nRETURN DISTINCT d.dittaId AS ditta\nORDER BY ditta",
      "expected_cypher": "MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)-[:APPARTIENE_A]->(:Sottofamiglia)-[:INCLUSA_IN]->(fam:Famiglia) WHERE toLower(trim(fam.nome)) = 'centrali frigo' RETURN DISTINCT d.dittaId AS ditta ORDER BY ditta",
      "time_total": 16.651979892980307,
      "time_generation": 2.4436214407905936,
      "time_db": 0.9481124780140817,
      "time_synthesis": 11.51400470174849
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_12_CONTEGGIO_CLIENTI_UNICI",
      "question": "Quanti clienti unici ha la ditta '1'?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente)\nRETURN COUNT(DISTINCT c) AS uniqueCustomers",
      "expected_cypher": "MATCH (d:Ditta {dittaId: '1'})<-[:APPARTIENE_A]-(c:Cliente) RETURN count(DISTINCT c) AS numeroClientiUnici",
      "time_total": 7.243882231879979,
      "time_generation": 1.0096365828067064,
      "time_db": 0.1910063629038632,
      "time_synthesis": 4.874959299806505
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_13_FORNITORE_CON_PIU_DOCUMENTI",
      "question": "Quale fornitore ci ha inviato pi\u00f9 documenti?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:HA_EMESSO]->(:Documento)\nRETURN f.ragioneSociale AS fornitore, count(*) AS numeroDocumenti\nORDER BY numeroDocumenti DESC\nLIMIT 1",
      "expected_cypher": "MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(doc:Documento) RETURN gf.ragioneSociale AS fornitore, count(doc) AS numeroDocumenti ORDER BY numeroDocumenti DESC LIMIT 1",
      "time_total": 9.170950897037983,
      "time_generation": 1.3690445353277028,
      "time_db": 0.15572622092440724,
      "time_synthesis": 6.010269469115883
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_14_CLIENTI_SENZA_PRODOTTO",
      "question": "Elenca 5 clienti che non hanno mai acquistato il prodotto 'GAS FREON SOLSTICE N40 R448A'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a'\nWITH a\nMATCH (c:Cliente)\nOPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)\nWHERE dr IS NULL\nRETURN DISTINCT c.name AS cliente\nORDER BY cliente\nLIMIT 5",
      "expected_cypher": "MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' WITH a MATCH (c:Cliente) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a) RETURN c.name AS cliente ORDER BY cliente LIMIT 5",
      "time_total": 13.092205275781453,
      "time_generation": 1.7935990788973868,
      "time_db": 0.3577803550288081,
      "time_synthesis": 9.971211885102093
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_15_LOCALITA_CON_PIU_FORNITORI",
      "question": "Qual \u00e8 la localit\u00e0 con il maggior numero di fornitori?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (f:Fornitore)-[:SI_TROVA_A]->(l:Luogo)\nRETURN l.localita AS localita, count(DISTINCT f) AS numeroFornitori\nORDER BY numeroFornitori DESC\nLIMIT 1",
      "expected_cypher": "MATCH (f:Fornitore)-[:SI_TROVA_A]->(l:Luogo) WHERE l.localita IS NOT NULL RETURN l.localita AS localita, count(DISTINCT f) AS numeroFornitori ORDER BY numeroFornitori DESC LIMIT 1",
      "time_total": 7.572047499008477,
      "time_generation": 1.8083714190870523,
      "time_db": 0.13199355779215693,
      "time_synthesis": 4.912604096811265
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_16_IMPORTO_MEDIO_RIGA",
      "question": "Qual \u00e8 l'importo medio per riga documento nelle fatture di vendita?",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) \nWHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 \nRETURN avg(dr.importo) AS importoMedioRiga",
      "expected_cypher": "MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento) WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 RETURN avg(dr.importo) AS importoMedioRiga",
      "time_total": 10.73173528490588,
      "time_generation": 1.7633147072046995,
      "time_db": 0.47044479520991445,
      "time_synthesis": 7.721003071870655
    },
    {
      "config": "hybrid-gpt4o-mini",
      "test_id": "TEST_17_FILTRO_MULTIPLO",
      "question": "Mostrami i documenti di tipo 'FVC' emessi a Gennaio 2025 al cliente 'L'ABBONDANZA SRL'",
      "success": true,
      "error": null,
      "generated_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType {codice: 'FVC'})\nWHERE toLower(trim(c.name)) = 'l\\'abbondanza srl' AND doc.dataEmissione.year = 2025 AND doc.dataEmissione.month = 1\nRETURN DISTINCT doc.documentoId AS documento\nORDER BY documento",
      "expected_cypher": "MATCH (c:Cliente)-[:HA_RICEVUTO]->(doc:Documento)-[:IS_TYPE]->(dt:DocType) WHERE toLower(trim(c.name)) = 'l\\'abbondanza srl' AND dt.codice = 'FVC' AND doc.dataEmissione.year = 2025 AND doc.dataEmissione.month = 1 RETURN doc.documentoId AS documento",
      "time_total": 12.67481347406283,
      "time_generation": 2.870174481999129,
      "time_db": 0.48814235581085086,
      "time_synthesis": 7.966949287801981
    }
  ]
}