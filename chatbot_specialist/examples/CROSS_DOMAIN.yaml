examples:
- id: cross_domain_023
  question: Qual è il margine di profitto del prodotto 'GAS FREON SOLSTICE N40 R448A'?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr1:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr1.tipoValore
    = 'Fatturato' AND dr1.importo > 0 WITH a, sum(dr1.importo) AS fatturato MATCH
    (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)
    WITH a, fatturato, sum(dr2.importo) AS costo RETURN a.descrizione AS prodotto,
    fatturato, costo, (fatturato - costo) AS margine
- id: cross_domain_023_var1
  question: Qual è il guadagno netto del prodotto 'GAS FREON SOLSTICE N40 R448A'?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr1:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr1.tipoValore
    = 'Fatturato' AND dr1.importo > 0 WITH a, sum(dr1.importo) AS fatturato MATCH
    (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)
    WITH a, fatturato, sum(dr2.importo) AS costo RETURN a.descrizione AS prodotto,
    fatturato, costo, (fatturato - costo) AS margine
- id: cross_domain_023_var2
  question: Qual è il profitto del prodotto 'GAS FREON SOLSTICE N40 R448A'?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr1:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE toLower(trim(a.descrizione)) = 'gas freon solstice n40 r448a' AND dr1.tipoValore
    = 'Fatturato' AND dr1.importo > 0 WITH a, sum(dr1.importo) AS fatturato MATCH
    (f:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)
    WITH a, fatturato, sum(dr2.importo) AS costo RETURN a.descrizione AS prodotto,
    fatturato, costo, (fatturato - costo) AS margine
- id: cross_domain_024
  question: Quali fornitori ci forniscono prodotti venduti al cliente 'BARONE DI FERRANTE
    EZIO'?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' WITH collect(DISTINCT
    a) AS articoliVenduti MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)
    WHERE a IN articoliVenduti RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER
    BY fornitore
- id: cross_domain_024_var1
  question: Quali sono i fornitori che ci forniscono i prodotti venduti al cliente
    'BARONE DI FERRANTE EZIO'?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' WITH collect(DISTINCT
    a) AS articoliVenduti MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)
    WHERE a IN articoliVenduti RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER
    BY fornitore
- id: cross_domain_024_var2
  question: Chi sono i fornitori che ci forniscono i prodotti destinati al cliente
    'BARONE DI FERRANTE EZIO'?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE toLower(trim(c.name)) = 'barone di ferrante ezio' WITH collect(DISTINCT
    a) AS articoliVenduti MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a)
    WHERE a IN articoliVenduti RETURN DISTINCT gf.ragioneSociale AS fornitore ORDER
    BY fornitore
- id: cross_domain_025
  question: Elenca 5 prodotti che abbiamo venduto ma mai acquistato
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE NOT EXISTS { MATCH (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    } RETURN DISTINCT a.descrizione AS prodotto ORDER BY prodotto LIMIT 5
- id: cross_domain_025_var1
  question: Variant 1
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE NOT EXISTS { MATCH (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    } RETURN DISTINCT a.descrizione AS prodotto ORDER BY prodotto LIMIT 5
- id: cross_domain_025_var2
  question: Quali sono 5 prodotti che abbiamo venduto senza mai comprarli?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE NOT EXISTS { MATCH (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    } RETURN DISTINCT a.descrizione AS prodotto ORDER BY prodotto LIMIT 5
- id: cross_domain_026
  question: Elenca 5 prodotti che abbiamo acquistato ma mai venduto
  cypher: 'MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: ''Fatturato''})
    RETURN DISTINCT a.descrizione AS prodottoMaiVenduto
    ORDER BY prodottoMaiVenduto LIMIT 5'
- id: cross_domain_026_var1
  question: Variant 1
  cypher: 'MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: ''Fatturato''})
    RETURN DISTINCT a.descrizione AS prodottoMaiVenduto
    ORDER BY prodottoMaiVenduto LIMIT 5'
  question: Variant 2
  cypher: 'MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore: ''Fatturato''})
    RETURN DISTINCT a.descrizione AS prodottoMaiVenduto
    ORDER BY prodottoMaiVenduto LIMIT 5'
- id: cross_domain_051
  question: Chi sono i principali fornitori degli articoli venduti al nostro miglior
    cliente?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS
    fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 1 WITH c AS topCliente MATCH
    (topCliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WITH topCliente, collect(DISTINCT a) AS articoliDelTopCliente MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE a IN articoliDelTopCliente RETURN gf.ragioneSociale AS fornitore, count(DISTINCT
    a) AS numeroArticoliDiversiForniti ORDER BY numeroArticoliDiversiForniti DESC
- id: cross_domain_051_var1
  question: Quali sono i fornitori principali degli articoli venduti al nostro cliente
    più importante?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS
    fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 1 WITH c AS topCliente MATCH
    (topCliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WITH topCliente, collect(DISTINCT a) AS articoliDelTopCliente MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE a IN articoliDelTopCliente RETURN gf.ragioneSociale AS fornitore, count(DISTINCT
    a) AS numeroArticoliDiversiForniti ORDER BY numeroArticoliDiversiForniti DESC
- id: cross_domain_051_var2
  question: Quali fornitori forniscono principalmente gli articoli venduti al nostro
    cliente migliore?
  cypher: MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    WHERE dr.tipoValore = 'Fatturato' AND dr.importo > 0 WITH c, sum(dr.importo) AS
    fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 1 WITH c AS topCliente MATCH
    (topCliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WITH topCliente, collect(DISTINCT a) AS articoliDelTopCliente MATCH (gf:GruppoFornitore)<-[:RAGGRUPPATO_SOTTO]-(:Fornitore)-[:HA_EMESSO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE a IN articoliDelTopCliente RETURN gf.ragioneSociale AS fornitore, count(DISTINCT
    a) AS numeroArticoliDiversiForniti ORDER BY numeroArticoliDiversiForniti DESC
- id: cross_domain_052
  question: Quali sono le famiglie di prodotti vendute sia dalla ditta '1' che dalla
    ditta '2'?
  cypher: 'MATCH (fam1:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta
    {dittaId: ''1''}) WITH collect(DISTINCT fam1) AS famiglieDitta1 MATCH (fam2:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta
    {dittaId: ''2''}) WHERE fam2 IN famiglieDitta1 RETURN DISTINCT fam2.nome AS famigliaComune
    ORDER BY famigliaComune'
- id: cross_domain_052_var1
  question: Variant 1
  cypher: 'MATCH (fam1:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta
    {dittaId: ''1''}) WITH collect(DISTINCT fam1) AS famiglieDitta1 MATCH (fam2:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta
    {dittaId: ''2''}) WHERE fam2 IN famiglieDitta1 RETURN DISTINCT fam2.nome AS famigliaComune
    ORDER BY famigliaComune'
- id: cross_domain_052_var2
  question: Quali categorie di prodotti sono offerte sia dall'azienda '1' che dall'azienda
    '2'?
  cypher: 'MATCH (fam1:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta
    {dittaId: ''1''}) WITH collect(DISTINCT fam1) AS famiglieDitta1 MATCH (fam2:Famiglia)<-[:INCLUSA_IN*0..]-(:Sottofamiglia)<-[:APPARTIENE_A]-(:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)-[:APPARTIENE_A]->(:Ditta
    {dittaId: ''2''}) WHERE fam2 IN famiglieDitta1 RETURN DISTINCT fam2.nome AS famigliaComune
    ORDER BY famigliaComune'
- id: cross_domain_053
  question: Mostrami 5 prodotti che abbiamo acquistato ma mai venduto.
  cypher: 'MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH DISTINCT a WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore:
    ''Fatturato''}) RETURN a.descrizione AS prodottoMaiVenduto LIMIT 5'
- id: cross_domain_053_var1
  question: Fammi vedere 5 prodotti che abbiamo comprato ma non venduto.
  cypher: 'MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH DISTINCT a WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore:
    ''Fatturato''}) RETURN a.descrizione AS prodottoMaiVenduto LIMIT 5'
- id: cross_domain_053_var2
  question: Visualizza 5 articoli che sono stati acquistati ma non sono mai stati
    venduti.
  cypher: 'MATCH (a:Articolo)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH DISTINCT a WHERE NOT (a)<-[:RIGUARDA_ARTICOLO]-(:RigaDocumento {tipoValore:
    ''Fatturato''}) RETURN a.descrizione AS prodottoMaiVenduto LIMIT 5'
- id: cross_domain_063
  question: Calcola il rapporto tra costo totale e fatturato totale per il prodotto
    'GAS FREON SOLSTICE N40 R448A'
  cypher: 'MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = ''gas freon solstice
    n40 r448a'' OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH a, sum(dr_acq.importo) AS costoTotale OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento
    {tipoValore: ''Fatturato''})<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)
    WHERE dr_ven.importo > 0 WITH costoTotale, sum(dr_ven.importo) AS fatturatoTotale
    RETURN  costoTotale, fatturatoTotale, CASE WHEN costoTotale <> 0 THEN fatturatoTotale
    / costoTotale ELSE null END AS rapporto'
- id: cross_domain_063_var1
  question: Variant 1
  cypher: 'MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = ''gas freon solstice
    n40 r448a'' OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH a, sum(dr_acq.importo) AS costoTotale OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento
    {tipoValore: ''Fatturato''})<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)
    WHERE dr_ven.importo > 0 WITH costoTotale, sum(dr_ven.importo) AS fatturatoTotale
    RETURN  costoTotale, fatturatoTotale, CASE WHEN costoTotale <> 0 THEN fatturatoTotale
    / costoTotale ELSE null END AS rapporto'
- id: cross_domain_063_var2
  question: Variant 2
  cypher: 'MATCH (a:Articolo) WHERE toLower(trim(a.descrizione)) = ''gas freon solstice
    n40 r448a'' OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH a, sum(dr_acq.importo) AS costoTotale OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento
    {tipoValore: ''Fatturato''})<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)
    WHERE dr_ven.importo > 0 WITH costoTotale, sum(dr_ven.importo) AS fatturatoTotale
    RETURN  costoTotale, fatturatoTotale, CASE WHEN costoTotale <> 0 THEN fatturatoTotale
    / costoTotale ELSE null END AS rapporto'
- id: cross_domain_082
  question: Per i primi 3 clienti per fatturato, mostra il loro prodotto più acquistato
    per valore.
  cypher: 'MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    WHERE dr.tipoValore = ''Fatturato'' AND dr.importo > 0 WITH c, sum(dr.importo)
    AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 3 MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE dr2.tipoValore = ''Fatturato'' AND dr2.importo > 0 WITH c, a, sum(dr2.importo)
    AS valoreProdotto ORDER BY c.name, valoreProdotto DESC WITH c, head(collect({prodotto:
    a.descrizione, valore: valoreProdotto})) AS topProdotto RETURN c.name AS cliente,
    topProdotto.prodotto AS prodottoTop, topProdotto.valore AS valoreTop ORDER BY
    c.name'
- id: cross_domain_082_var1
  question: 'Variant 1: Per i tre clienti principali in termini di fatturato, indica
    il prodotto che hanno acquistato di più in valore.'
  cypher: 'MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    WHERE dr.tipoValore = ''Fatturato'' AND dr.importo > 0 WITH c, sum(dr.importo)
    AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 3 MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE dr2.tipoValore = ''Fatturato'' AND dr2.importo > 0 WITH c, a, sum(dr2.importo)
    AS valoreProdotto ORDER BY c.name, valoreProdotto DESC WITH c, head(collect({prodotto:
    a.descrizione, valore: valoreProdotto})) AS topProdotto RETURN c.name AS cliente,
    topProdotto.prodotto AS prodottoTop, topProdotto.valore AS valoreTop ORDER BY
    c.name'
- id: cross_domain_082_var2
  question: 'Variant 2: Mostra il prodotto con il valore d''acquisto più alto per
    i primi tre clienti per fatturato.'
  cypher: 'MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    WHERE dr.tipoValore = ''Fatturato'' AND dr.importo > 0 WITH c, sum(dr.importo)
    AS fatturatoCliente ORDER BY fatturatoCliente DESC LIMIT 3 MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr2:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WHERE dr2.tipoValore = ''Fatturato'' AND dr2.importo > 0 WITH c, a, sum(dr2.importo)
    AS valoreProdotto ORDER BY c.name, valoreProdotto DESC WITH c, head(collect({prodotto:
    a.descrizione, valore: valoreProdotto})) AS topProdotto RETURN c.name AS cliente,
    topProdotto.prodotto AS prodottoTop, topProdotto.valore AS valoreTop ORDER BY
    c.name'
- id: cross_domain_083
  question: Quali clienti hanno effettuato ordini ma non hanno ancora ricevuto una
    fattura?
  cypher: 'MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento
    {tipoValore: ''Ordinato''}) WITH DISTINCT c MATCH (c) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento
    {tipoValore: ''Fatturato''}) RETURN c.name AS clienteSenzaFattura'
- id: cross_domain_083_var1
  question: Variant 1
  cypher: 'MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento
    {tipoValore: ''Ordinato''}) WITH DISTINCT c MATCH (c) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento
    {tipoValore: ''Fatturato''}) RETURN c.name AS clienteSenzaFattura'
- id: cross_domain_083_var2
  question: Quali sono i clienti che hanno fatto ordini ma non hanno ricevuto ancora
    una fattura?
  cypher: 'MATCH (c:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento
    {tipoValore: ''Ordinato''}) WITH DISTINCT c MATCH (c) WHERE NOT (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(:RigaDocumento
    {tipoValore: ''Fatturato''}) RETURN c.name AS clienteSenzaFattura'
- id: cross_domain_087
  question: Per il prodotto più venduto per quantità, qual è il suo costo medio di
    acquisto?
  cypher: MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WITH a, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT
    1 MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    RETURN a.descrizione AS prodotto, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita
    IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedioUnitario
- id: cross_domain_087_var1
  question: 'Variant 1: Qual è il costo medio di acquisto del prodotto venduto in
    maggior quantità?'
  cypher: MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WITH a, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT
    1 MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    RETURN a.descrizione AS prodotto, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita
    IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedioUnitario
- id: cross_domain_087_var2
  question: 'Variant 2: Qual è il prezzo medio di acquisto del prodotto con il maggior
    numero di vendite?'
  cypher: MATCH (:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)-[:RIGUARDA_ARTICOLO]->(a:Articolo)
    WITH a, sum(dr.quantita) AS quantitaTotale ORDER BY quantitaTotale DESC LIMIT
    1 MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    RETURN a.descrizione AS prodotto, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita
    IS NULL THEN null ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedioUnitario
- id: cross_domain_092
  question: Ci sono prodotti venduti a un prezzo inferiore al loro costo medio di
    acquisto?
  cypher: MATCH (a:Articolo) OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH a, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null
    ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedio OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)
    WHERE dr_ven.tipoValore = 'Fatturato' AND dr_ven.importo > 0 WITH a, costoMedio,
    avg(CASE WHEN dr_ven.quantita = 0 OR dr_ven.quantita IS NULL THEN null ELSE dr_ven.importo
    / dr_ven.quantita END) AS prezzoMedioVendita WHERE prezzoMedioVendita < costoMedio
    RETURN a.descrizione AS prodottoInPerdita
- id: cross_domain_092_var1
  question: Esistono articoli venduti a un prezzo più basso rispetto al loro costo
    medio di acquisto?
  cypher: MATCH (a:Articolo) OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH a, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null
    ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedio OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)
    WHERE dr_ven.tipoValore = 'Fatturato' AND dr_ven.importo > 0 WITH a, costoMedio,
    avg(CASE WHEN dr_ven.quantita = 0 OR dr_ven.quantita IS NULL THEN null ELSE dr_ven.importo
    / dr_ven.quantita END) AS prezzoMedioVendita WHERE prezzoMedioVendita < costoMedio
    RETURN a.descrizione AS prodottoInPerdita
- id: cross_domain_092_var2
  question: Vi sono prodotti che vengono venduti a un prezzo inferiore rispetto al
    loro costo medio di acquisto?
  cypher: MATCH (a:Articolo) OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_acq:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_EMESSO]-(:Fornitore)
    WITH a, avg(CASE WHEN dr_acq.quantita = 0 OR dr_acq.quantita IS NULL THEN null
    ELSE dr_acq.importo / dr_acq.quantita END) AS costoMedio OPTIONAL MATCH (a)<-[:RIGUARDA_ARTICOLO]-(dr_ven:RigaDocumento)<-[:CONTIENE_RIGA]-(:Documento)<-[:HA_RICEVUTO]-(:Cliente)
    WHERE dr_ven.tipoValore = 'Fatturato' AND dr_ven.importo > 0 WITH a, costoMedio,
    avg(CASE WHEN dr_ven.quantita = 0 OR dr_ven.quantita IS NULL THEN null ELSE dr_ven.importo
    / dr_ven.quantita END) AS prezzoMedioVendita WHERE prezzoMedioVendita < costoMedio
    RETURN a.descrizione AS prodottoInPerdita
- id: cross_domain_103
  question: Per il cliente 'ACME SRL', confronta il totale ordinato e il totale fatturato.
  cypher: 'MATCH (c:Cliente) WHERE toLower(trim(c.name)) = ''acme srl'' OPTIONAL MATCH
    (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_ord:RigaDocumento {tipoValore:
    ''Ordinato''}) WITH c, sum(dr_ord.importo) AS totaleOrdinato OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento
    {tipoValore: ''Fatturato''}) WHERE dr_fat.importo > 0 RETURN totaleOrdinato, sum(dr_fat.importo)
    AS totaleFatturato'
- id: cross_domain_103_var1
  question: Confronta il totale degli ordini e il totale delle fatture per il cliente
    'ACME SRL'.
  cypher: 'MATCH (c:Cliente) WHERE toLower(trim(c.name)) = ''acme srl'' OPTIONAL MATCH
    (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_ord:RigaDocumento {tipoValore:
    ''Ordinato''}) WITH c, sum(dr_ord.importo) AS totaleOrdinato OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento
    {tipoValore: ''Fatturato''}) WHERE dr_fat.importo > 0 RETURN totaleOrdinato, sum(dr_fat.importo)
    AS totaleFatturato'
- id: cross_domain_103_var2
  question: Per il cliente 'ACME SRL', verifica la differenza tra il totale degli
    ordini e il totale delle fatture.
  cypher: 'MATCH (c:Cliente) WHERE toLower(trim(c.name)) = ''acme srl'' OPTIONAL MATCH
    (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_ord:RigaDocumento {tipoValore:
    ''Ordinato''}) WITH c, sum(dr_ord.importo) AS totaleOrdinato OPTIONAL MATCH (c)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr_fat:RigaDocumento
    {tipoValore: ''Fatturato''}) WHERE dr_fat.importo > 0 RETURN totaleOrdinato, sum(dr_fat.importo)
    AS totaleFatturato'
- id: cross_domain_106
  question: Mostrami il totale fatturato e il totale ordinato per ciascuna ditta.
  cypher: MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    RETURN d.dittaId AS ditta, sum(CASE dr.tipoValore WHEN 'Fatturato' THEN dr.importo
    ELSE 0 END) AS totaleFatturato, sum(CASE dr.tipoValore WHEN 'Ordinato' THEN dr.importo
    ELSE 0 END) AS totaleOrdinato ORDER BY ditta ASC
- id: cross_domain_106_var1
  question: Variant 1
  cypher: MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    RETURN d.dittaId AS ditta, sum(CASE dr.tipoValore WHEN 'Fatturato' THEN dr.importo
    ELSE 0 END) AS totaleFatturato, sum(CASE dr.tipoValore WHEN 'Ordinato' THEN dr.importo
    ELSE 0 END) AS totaleOrdinato ORDER BY ditta ASC
- id: cross_domain_106_var2
  question: Fammi vedere il totale delle vendite e degli ordini per ogni azienda.
  cypher: MATCH (d:Ditta)<-[:APPARTIENE_A]-(:Cliente)-[:HA_RICEVUTO]->(:Documento)-[:CONTIENE_RIGA]->(dr:RigaDocumento)
    RETURN d.dittaId AS ditta, sum(CASE dr.tipoValore WHEN 'Fatturato' THEN dr.importo
    ELSE 0 END) AS totaleFatturato, sum(CASE dr.tipoValore WHEN 'Ordinato' THEN dr.importo
    ELSE 0 END) AS totaleOrdinato ORDER BY ditta ASC
